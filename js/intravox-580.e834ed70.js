/*! For license information please see intravox-580.e834ed70.js.LICENSE.txt */
"use strict";(self.webpackChunknextcloud_intravox=self.webpackChunknextcloud_intravox||[]).push([[580],{61580(e,t,r){r.r(t),r.d(t,{default:()=>w});var i=r(20641),n=r(50953),s=r(90033),a=r(21777),o=r(53053),c=r(94434),l=r(11008),u=r(79455),d=r(87651),m=r(38040),h=r(50240);function p(e){if(""===e.trim())return(0,d.t)("Names must not be empty.");if(e.startsWith("."))return(0,d.t)("Names must not start with a dot.");if(e.length>64)return(0,d.t)("Names may be at most 64 characters long.");try{return(0,m.KT)(e),""}catch(e){if(!(e instanceof m.di))throw e;switch(e.reason){case m.nF.Character:return(0,d.t)('"{char}" is not allowed inside a name.',{char:e.segment});case m.nF.ReservedName:return(0,d.t)('"{segment}" is a reserved name and not allowed.',{segment:e.segment});case m.nF.Extension:return e.segment.match(/\.[a-z]/i)?(0,d.t)('"{extension}" is not an allowed name.',{extension:e.segment}):(0,d.t)('Names must not end with "{extension}".',{extension:e.segment});default:return(0,d.t)("Invalid name.")}}}const f={key:0,class:"public-auth-prompt__text"},g=(0,i.pM)({__name:"PublicAuthPrompt",props:{nickname:{default:""},title:{default:(0,d.t)("Guest identification")},text:{default:""},notice:{default:""},submitLabel:{default:(0,d.t)("Submit name")},cancellable:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const r=e,m=t,h=(0,i.rk)("input"),g=(0,o.c0)("public").build(),w=(0,n.KR)(r.nickname);(0,i.wB)(()=>r.nickname,()=>{w.value=r.nickname}),(0,i.wB)(w,e=>{const t=p(e);t||!h.value||y(t)});const v=(0,i.EW)(()=>{const e={label:(0,d.t)("Cancel"),variant:"tertiary",callback:()=>m("close")},t={label:r.submitLabel,type:"submit",variant:"primary"};return r.cancellable?[e,t]:[t]}),b=(0,i.EW)(()=>r.notice?r.notice:w.value?(0,d.t)("You are currently identified as {nickname}.",{nickname:w.value}):(0,d.t)("You are currently not identified."));function _(){const e=w.value.trim(),t=p(e);if(t)y(t);else if(""!==e)if(e.length<2)y((0,d.t)("Please enter a name with at least 2 characters."));else{try{(0,a.L$)(e)}catch(e){return d.l.error("Failed to set nickname",{error:e}),(0,d.s)((0,d.t)("Failed to set nickname.")),void h.value.focus()}g.setItem("public-auth-prompt-shown","true"),m("close",w.value)}else y((0,d.t)("You cannot leave the name empty."))}function y(e){h.value&&(h.value.setCustomValidity(e),h.value.reportValidity(),h.value.focus())}return(t,r)=>((0,i.uX)(),(0,i.Wv)((0,n.R1)(c.A),{buttons:v.value,class:"public-auth-prompt","data-cy-public-auth-prompt-dialog":"",isForm:"",noClose:"",name:e.title,onSubmit:_},{default:(0,i.k6)(()=>[e.text?((0,i.uX)(),(0,i.CE)("p",f,(0,s.v_)(e.text),1)):(0,i.Q3)("",!0),(0,i.bF)((0,n.R1)(l.A),{class:"public-auth-prompt__header",text:b.value,type:"info"},null,8,["text"]),(0,i.bF)((0,n.R1)(u.A),{ref:"input",modelValue:w.value,"onUpdate:modelValue":r[0]||(r[0]=e=>w.value=e),class:"public-auth-prompt__input","data-cy-public-auth-prompt-dialog-name":"",label:(0,n.R1)(d.t)("Name"),placeholder:(0,n.R1)(d.t)("Enter your name"),required:!e.cancellable,minlength:"2",maxlength:"64",name:"name"},null,8,["modelValue","label","placeholder","required"])]),_:1},8,["buttons","name"]))}}),w=(0,h._)(g,[["__scopeId","data-v-bd4b7f1b"]])},50240(e,t,r){r.d(t,{_:()=>i});const i=(e,t)=>{const r=e.__vccOpts||e;for(const[e,i]of t)r[e]=i;return r}},72094(e,t,r){r.d(t,{F:()=>a,P:()=>o,a:()=>m,b:()=>h,c:()=>c,s:()=>s});var i=r(35947),n=r(41133);window._nc_files_scope??={},window._nc_files_scope.v4_0??={};const s=window._nc_files_scope.v4_0,a=((0,i.YK)().setApp("@nextcloud/files").detectUser().build(),Object.freeze({Folder:"folder",File:"file"})),o=Object.freeze({NONE:0,READ:1,UPDATE:2,CREATE:4,WRITE:4,DELETE:8,SHARE:16,ALL:31}),c=Object.freeze({NEW:"new",FAILED:"failed",LOADING:"loading",LOCKED:"locked"});function l(e,t){return null!==e.match(t)}function u(e,t){if(e.id&&"number"!=typeof e.id&&"string"!=typeof e.id)throw new Error("Invalid id type of value");if(!e.source)throw new Error("Missing mandatory source");try{new URL(e.source)}catch{throw new Error("Invalid source format, source must be a valid URL")}if(!e.source.startsWith("http"))throw new Error("Invalid source format, only http(s) is supported");if(!e.root)throw new Error("Missing mandatory root");if("string"!=typeof e.root)throw new Error("Invalid root type");if(!e.root.startsWith("/"))throw new Error("Root must start with a leading slash");if(!e.source.includes(e.root))throw new Error("Root must be part of the source");if(l(e.source,t)){const r=e.source.match(t)[0];if(!e.source.includes((0,n.fj)(r,e.root)))throw new Error("The root must be relative to the service. e.g /files/emma")}if(e.displayname&&"string"!=typeof e.displayname)throw new Error("Invalid displayname type");if(e.mtime&&!(e.mtime instanceof Date))throw new Error("Invalid mtime type");if(e.crtime&&!(e.crtime instanceof Date))throw new Error("Invalid crtime type");if(!e.mime||"string"!=typeof e.mime||!e.mime.match(/^[-\w.]+\/[-+\w.]+$/gi))throw new Error("Missing or invalid mandatory mime");if("size"in e&&"number"!=typeof e.size&&void 0!==e.size)throw new Error("Invalid size type");if("permissions"in e&&void 0!==e.permissions&&!("number"==typeof e.permissions&&e.permissions>=o.NONE&&e.permissions<=o.ALL))throw new Error("Invalid permissions");if(e.owner&&null!==e.owner&&"string"!=typeof e.owner)throw new Error("Invalid owner type");if(e.attributes&&"object"!=typeof e.attributes)throw new Error("Invalid attributes type");if(e.status&&!Object.values(c).includes(e.status))throw new Error("Status must be a valid NodeStatus")}class d{_attributes;_data;_knownDavService=/(remote|public)\.php\/(web)?dav/i;readonlyAttributes=Object.entries(Object.getOwnPropertyDescriptors(d.prototype)).filter(e=>"function"==typeof e[1].get&&"__proto__"!==e[0]).map(e=>e[0]);handler={set:(e,t,r)=>!this.readonlyAttributes.includes(t)&&Reflect.set(e,t,r),deleteProperty:(e,t)=>!this.readonlyAttributes.includes(t)&&Reflect.deleteProperty(e,t)};constructor(...[e,t]){e.mime||(e.mime="application/octet-stream"),function(e){e.mtime&&"string"==typeof e.mtime&&(isNaN(Date.parse(e.mtime))||JSON.stringify(new Date(e.mtime))!==JSON.stringify(e.mtime)||(e.mtime=new Date(e.mtime))),e.crtime&&"string"==typeof e.crtime&&(isNaN(Date.parse(e.crtime))||JSON.stringify(new Date(e.crtime))!==JSON.stringify(e.crtime)||(e.crtime=new Date(e.crtime)))}(e),u(e,t=function(e){if(e instanceof RegExp)return e;const t=e.match(/(\/?)(.+)\1([a-z]*)/i);if(!t)throw new Error("Invalid regular expression format.");const r=Array.from(new Set(t[3])).filter(e=>"gimsuy".includes(e)).join("");return new RegExp(t[2],r)}(t||this._knownDavService)),this._data={...e,attributes:{}},this._attributes=new Proxy(this._data.attributes,this.handler),this.update(e.attributes??{}),t&&(this._knownDavService=t)}get source(){return this._data.source.replace(/\/$/i,"")}get encodedSource(){const{origin:e}=new URL(this.source);return e+(0,n.O0)(this.source.slice(e.length))}get basename(){return(0,n.P8)(this.source)}get displayname(){return this._data.displayname||this.basename}set displayname(e){u({...this._data,displayname:e},this._knownDavService),this._data.displayname=e}get extension(){return(0,n.LC)(this.source)}get dirname(){return(0,n.pD)(this.path)}get mime(){return this._data.mime||"application/octet-stream"}set mime(e){e??="application/octet-stream",u({...this._data,mime:e},this._knownDavService),this._data.mime=e}get mtime(){return this._data.mtime}set mtime(e){u({...this._data,mtime:e},this._knownDavService),this._data.mtime=e}get crtime(){return this._data.crtime}get size(){return this._data.size}set size(e){u({...this._data,size:e},this._knownDavService),this.updateMtime(),this._data.size=e}get attributes(){return this._attributes}get permissions(){return null!==this.owner||this.isDavResource?void 0!==this._data.permissions?this._data.permissions:o.NONE:o.READ}set permissions(e){u({...this._data,permissions:e},this._knownDavService),this.updateMtime(),this._data.permissions=e}get owner(){return this.isDavResource?this._data.owner:null}get isDavResource(){return l(this.source,this._knownDavService)}get root(){return this._data.root.replace(/^(.+)\/$/,"$1")}get path(){const e=this.source.indexOf("://"),t=this.source.slice(0,e),r=this.source.slice(e+3),i=r.indexOf("/"),s=r.slice(0,i),a=r.slice(i),o=`${t}://${s}${(0,n.O0)(a)}`,c=new URL(o);let l=decodeURIComponent(c.pathname);this.isDavResource&&(l=l.split(this._knownDavService).pop());const u=l.indexOf(this.root),d=this.root.replace(/\/$/,"");return l.slice(u+d.length)||"/"}get fileid(){return"number"==typeof this._data?.id?this._data.id:void 0}get id(){if(!(void 0===this._data?.id||"number"==typeof this._data.id&&this._data.id<0))return String(this._data.id)}get status(){return this._data?.status}set status(e){u({...this._data,status:e},this._knownDavService),this._data.status=e}move(e){u({...this._data,source:e},this._knownDavService);const t=this.basename;this._data.source=e,this.displayname===t&&this.basename!==t&&(this.displayname=this.basename)}rename(e){if(e.includes("/"))throw new Error("Invalid basename");this.move((0,n.pD)(this.source)+"/"+e)}updateMtime(){this._data.mtime&&(this._data.mtime=new Date)}update(e){for(const[t,r]of Object.entries(e))try{void 0===r?delete this.attributes[t]:this.attributes[t]=r}catch(e){if(e instanceof TypeError)continue;throw e}}clone(){return new this.constructor(structuredClone(this._data),this._knownDavService)}toJSON(){return JSON.stringify([structuredClone(this._data),this._knownDavService.toString()])}}class m extends d{constructor(...[e,t]){super(e,t)}get type(){return a.File}}class h extends d{constructor(...[e,t]){super({...e,mime:"httpd/unix-directory"},t)}get type(){return a.Folder}get extension(){return null}get mime(){return"httpd/unix-directory"}}},38040(e,t,r){r.d(t,{pt:()=>i.F,di:()=>o,nF:()=>a,aX:()=>i.P,v7:()=>d,ur:()=>p,KT:()=>c});var i=r(72094),n=(EventTarget,r(87485)),s=r(53334);Object.freeze({DEFAULT:"default",HIDDEN:"hidden"}),Object.freeze({UploadFromDevice:0,CreateNew:1,Other:2});const a=Object.freeze({ReservedName:"reserved name",Character:"character",Extension:"extension"});class o extends Error{constructor(e){super(`Invalid ${e.reason} '${e.segment}' in filename '${e.filename}'`,{cause:e})}get filename(){return this.cause.filename}get reason(){return this.cause.reason}get segment(){return this.cause.segment}}function c(e){const t=(0,n.F)().files,r=t.forbidden_filename_characters??["/","\\"];for(const t of r)if(e.includes(t))throw new o({segment:t,reason:a.Character,filename:e});if(e=e.toLocaleLowerCase(),(t.forbidden_filenames??[".htaccess"]).includes(e))throw new o({filename:e,segment:e,reason:a.ReservedName});const i=e.indexOf(".",1),s=e.substring(0,-1===i?void 0:i);if((t.forbidden_filename_basenames??[]).includes(s))throw new o({filename:e,segment:s,reason:a.ReservedName});const c=t.forbidden_filename_extensions??[];for(const t of c)if(e.length>t.length&&e.endsWith(t))throw new o({segment:t,reason:a.Extension,filename:e})}const l=["B","KB","MB","GB","TB","PB"],u=["B","KiB","MiB","GiB","TiB","PiB"];function d(e,t=!1,r=!1,i=!1){r=r&&!i,"string"==typeof e&&(e=Number(e));let n=e>0?Math.floor(Math.log(e)/Math.log(i?1e3:1024)):0;n=Math.min((r?u.length:l.length)-1,n);const a=r?u[n]:l[n];let o=(e/Math.pow(i?1e3:1024,n)).toFixed(1);return!0===t&&0===n?("0.0"!==o?"< 1 ":"0 ")+(r?u[1]:l[1]):(o=n<2?parseFloat(o).toFixed(0):parseFloat(o).toLocaleString((0,s.lO)()),o+" "+a)}function m(e){return e instanceof Date?e.toISOString():String(e)}const h=Object.freeze({Name:"basename",Modified:"mtime",Size:"size"});function p(e,t={}){const r={sortingMode:h.Name,sortingOrder:"asc",...t};return function(e,t,r){r=r??[];const i=(t=t??[e=>e]).map((e,t)=>"asc"===(r[t]??"asc")?1:-1),n=Intl.Collator([(0,s.Z0)(),(0,s.lO)()],{numeric:!0,usage:"sort"});return[...e].sort((e,r)=>{for(const[s,a]of t.entries()){const t=n.compare(m(a(e)),m(a(r)));if(0!==t)return t*i[s]}return 0})}(e,[...r.sortFavoritesFirst?[e=>1!==e.attributes?.favorite]:[],...r.sortFoldersFirst?[e=>"folder"!==e.type]:[],...r.sortingMode!==h.Name?[e=>e[r.sortingMode]??e.attributes[r.sortingMode]]:[],e=>function(e){const t=e.displayname||e.attributes?.displayname||e.basename||"";return e.type===i.F.Folder?t:t.lastIndexOf(".")>0?t.slice(0,t.lastIndexOf(".")):t}(e),e=>e.basename],[...r.sortFavoritesFirst?["asc"]:[],...r.sortFoldersFirst?["asc"]:[],...r.sortingMode===h.Modified?["asc"===r.sortingOrder?"desc":"asc"]:[],...r.sortingMode!==h.Modified&&r.sortingMode!==h.Name?[r.sortingOrder]:[],r.sortingOrder,r.sortingOrder])}},41133(e,t,r){function i(e){return e?e.split("/").map(encodeURIComponent).join("/"):e}function n(e,t){return e=e.replace(/\\/g,"/").replace(/\/+$/g,"").replace(/.*\//,""),t&&t!==e&&e.endsWith(t)?e.substring(0,e.length-t.length):e}function s(e){const t=(e=e.replaceAll(/\\/g,"/")).split("/");return t.length<=1?".":(t.pop(),1===t.length&&""===t[0]?"/":t.join("/"))}function a(e){const t=n(e),r=t.lastIndexOf(".");return r>0?t.substring(r):""}function o(...e){if(arguments.length<1)return"";const t=e.filter(e=>e.length>0);if(t.length<1)return"";const r=t[t.length-1],i="/"===t[0].charAt(0),n="/"===r.charAt(r.length-1),s=t.reduce((e,t)=>e.concat(t.split("/")),[]);let a=!i;const o=s.reduce((e,t)=>""===t?e:a?(a=!1,e+t):e+"/"+t,"");return n?o+"/":o}r.d(t,{LC:()=>a,O0:()=>i,P8:()=>n,fj:()=>o,pD:()=>s})},79455(e,t,r){r.d(t,{A:()=>i._});var i=r(35032)}}]);