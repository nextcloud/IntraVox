"use strict";(self.webpackChunknextcloud_intravox=self.webpackChunknextcloud_intravox||[]).push([[69],{1503:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(1601),i=a.n(n),r=a(6314),o=a.n(r)()(i());o.push([e.id,"\n/* NcAppSidebar handles its own styling */\n.loading[data-v-5c84ae99],\n.empty-state[data-v-5c84ae99] {\n  text-align: center;\n  padding: 20px;\n  color: var(--color-text-maxcontrast);\n}\n.empty-state .hint[data-v-5c84ae99] {\n  font-size: 12px;\n  margin-top: 8px;\n}\n.error-message[data-v-5c84ae99] {\n  padding: 12px;\n  background: var(--color-error);\n  color: white;\n  border-radius: var(--border-radius);\n  margin-bottom: 12px;\n}\n.version-list[data-v-5c84ae99] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.version-item[data-v-5c84ae99] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px;\n  background: var(--color-background-hover);\n  border-radius: var(--border-radius);\n  transition: background 0.2s, border-color 0.2s;\n  border: 2px solid transparent;\n  cursor: pointer;\n}\n.version-item[data-v-5c84ae99]:hover {\n  background: var(--color-background-dark);\n}\n.version-item--selected[data-v-5c84ae99] {\n  background: var(--color-primary-element-light);\n  border-color: var(--color-primary-element);\n}\n.version-info[data-v-5c84ae99] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n.version-header[data-v-5c84ae99] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex-wrap: wrap;\n}\n.version-date[data-v-5c84ae99] {\n  font-weight: 600;\n  font-size: 14px;\n}\n.version-author[data-v-5c84ae99] {\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n  font-style: italic;\n}\n.version-details[data-v-5c84ae99] {\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n}\n.version-label[data-v-5c84ae99] {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 4px 8px;\n  background: var(--color-background-dark);\n  color: var(--color-main-text);\n  border-radius: var(--border-radius);\n  font-size: 12px;\n  width: fit-content;\n  margin-top: 4px;\n}\n.version-label-edit[data-v-5c84ae99] {\n  margin-top: 8px;\n}\n.label-actions[data-v-5c84ae99] {\n  display: flex;\n  gap: 8px;\n  margin-top: 8px;\n}\n.version-actions[data-v-5c84ae99] {\n  display: flex;\n  gap: 4px;\n  align-items: center;\n}\n.coming-soon[data-v-5c84ae99] {\n  font-style: italic;\n  color: var(--color-text-maxcontrast);\n}\n\n/* Metadata container */\n.metadata-container[data-v-5c84ae99] {\n  padding: 12px;\n}\n.metadata-row[data-v-5c84ae99] {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  padding: 12px 0;\n  border-bottom: 1px solid var(--color-border);\n}\n.metadata-row[data-v-5c84ae99]:last-child {\n  border-bottom: none;\n}\n.metadata-label[data-v-5c84ae99] {\n  font-size: 12px;\n  font-weight: 600;\n  color: var(--color-text-maxcontrast);\n}\n.metadata-value[data-v-5c84ae99] {\n  font-size: 14px;\n  color: var(--color-main-text);\n  word-break: break-word;\n}\n.metadata-hint[data-v-5c84ae99] {\n  display: block;\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n  margin-top: 2px;\n}\n.metadata-path[data-v-5c84ae99] {\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n}\n.folder-link[data-v-5c84ae99] {\n  color: var(--color-primary-element);\n  text-decoration: none;\n  border-bottom: 1px dotted var(--color-primary-element);\n  transition: border-bottom 0.2s;\n}\n.folder-link[data-v-5c84ae99]:hover {\n  border-bottom: 1px solid var(--color-primary-element);\n}\n.metadata-monospace[data-v-5c84ae99] {\n  font-family: monospace;\n  font-size: 12px;\n  background: var(--color-background-hover);\n  padding: 4px 8px;\n  border-radius: var(--border-radius);\n}\n.page-type-badge[data-v-5c84ae99] {\n  display: inline-block;\n  padding: 4px 12px;\n  border-radius: var(--border-radius-large);\n  font-size: 12px;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n.page-type-department[data-v-5c84ae99] {\n  background: #10b981;\n  color: white;\n}\n.page-type-container[data-v-5c84ae99] {\n  background: #3b82f6;\n  color: white;\n}\n.page-type-page[data-v-5c84ae99] {\n  background: var(--color-background-dark);\n  color: var(--color-main-text);\n}\n.metadata-editable[data-v-5c84ae99] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.metadata-text[data-v-5c84ae99] {\n  padding: 4px;\n  border-radius: var(--border-radius);\n  transition: background 0.2s;\n}\n.metadata-text--editable[data-v-5c84ae99] {\n  cursor: pointer;\n}\n.metadata-text--editable[data-v-5c84ae99]:hover {\n  background: var(--color-background-hover);\n}\n.title-input[data-v-5c84ae99] {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid var(--color-border);\n  border-radius: var(--border-radius);\n  font-size: 14px;\n  background: var(--color-main-background);\n  color: var(--color-main-text);\n}\n.title-input[data-v-5c84ae99]:focus {\n  outline: none;\n  border-color: var(--color-primary-element);\n}\n.metadata-editable[data-v-5c84ae99] .button-vue {\n  margin-right: 8px;\n}\n\n/* MetaVox container */\n.metavox-container[data-v-5c84ae99] {\n  padding: 12px;\n  min-height: 200px;\n}\n\n/* Preview dialog */\n.preview-loading[data-v-5c84ae99] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px;\n  gap: 16px;\n  color: var(--color-text-maxcontrast);\n}\n.preview-container[data-v-5c84ae99] {\n  display: flex;\n  flex-direction: column;\n  height: 70vh;\n  max-height: 800px;\n}\n.preview-header[data-v-5c84ae99] {\n  padding: 20px 20px 16px 20px;\n  border-bottom: 1px solid var(--color-border);\n  flex-shrink: 0;\n}\n.preview-header h3[data-v-5c84ae99] {\n  margin: 0 0 8px 0;\n  font-size: 20px;\n  font-weight: 600;\n}\n.preview-meta[data-v-5c84ae99] {\n  margin: 0;\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n}\n.preview-tabs[data-v-5c84ae99] {\n  display: flex;\n  gap: 0;\n  border-bottom: 1px solid var(--color-border);\n  flex-shrink: 0;\n  padding: 0 20px;\n}\n.preview-tabs button[data-v-5c84ae99] {\n  padding: 12px 20px;\n  background: none;\n  border: none;\n  border-bottom: 2px solid transparent;\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 500;\n  color: var(--color-text-maxcontrast);\n  transition: all 0.2s;\n}\n.preview-tabs button[data-v-5c84ae99]:hover {\n  color: var(--color-main-text);\n  background: var(--color-background-hover);\n}\n.preview-tabs button.active[data-v-5c84ae99] {\n  color: var(--color-primary-element);\n  border-bottom-color: var(--color-primary-element);\n}\n.preview-content[data-v-5c84ae99] {\n  padding: 20px;\n  overflow-y: auto;\n  flex: 1;\n  min-height: 0;\n}\n.preview-body[data-v-5c84ae99] {\n  line-height: 1.6;\n}\n.preview-body[data-v-5c84ae99] h1,\n.preview-body[data-v-5c84ae99] h2,\n.preview-body[data-v-5c84ae99] h3,\n.preview-body[data-v-5c84ae99] h4,\n.preview-body[data-v-5c84ae99] h5,\n.preview-body[data-v-5c84ae99] h6 {\n  margin-top: 1.5em;\n  margin-bottom: 0.5em;\n}\n.preview-body[data-v-5c84ae99] p {\n  margin-bottom: 1em;\n}\n.preview-body[data-v-5c84ae99] ul,\n.preview-body[data-v-5c84ae99] ol {\n  margin-left: 1.5em;\n  margin-bottom: 1em;\n}\n.preview-source pre[data-v-5c84ae99] {\n  background: var(--color-background-dark);\n  padding: 16px;\n  border-radius: var(--border-radius);\n  overflow-x: auto;\n  font-family: 'Courier New', monospace;\n  font-size: 13px;\n  line-height: 1.5;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n}\n\n/* Diff viewer */\n.preview-diff[data-v-5c84ae99] {\n  height: 100%;\n}\n.diff-loading[data-v-5c84ae99] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px;\n  gap: 16px;\n  color: var(--color-text-maxcontrast);\n}\n.diff-error[data-v-5c84ae99] {\n  padding: 20px;\n  text-align: center;\n  color: var(--color-text-maxcontrast);\n}\n.diff-viewer[data-v-5c84ae99] {\n  font-family: 'Courier New', monospace;\n  font-size: 13px;\n  line-height: 1.5;\n  background: var(--color-background-dark);\n  border-radius: var(--border-radius);\n  overflow: hidden;\n}\n.diff-viewer > div[data-v-5c84ae99] {\n  display: flex;\n  padding: 2px 8px;\n  border-left: 3px solid transparent;\n}\n.diff-prefix[data-v-5c84ae99] {\n  display: inline-block;\n  width: 20px;\n  flex-shrink: 0;\n  font-weight: bold;\n  user-select: none;\n}\n.diff-line[data-v-5c84ae99] {\n  flex: 1;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n}\n.diff-added[data-v-5c84ae99] {\n  background: rgba(16, 185, 129, 0.15);\n  border-left-color: #10b981;\n}\n.diff-added .diff-prefix[data-v-5c84ae99] {\n  color: #10b981;\n}\n.diff-removed[data-v-5c84ae99] {\n  background: rgba(239, 68, 68, 0.15);\n  border-left-color: #ef4444;\n}\n.diff-removed .diff-prefix[data-v-5c84ae99] {\n  color: #ef4444;\n}\n.diff-unchanged[data-v-5c84ae99] {\n  background: transparent;\n}\n.diff-unchanged .diff-prefix[data-v-5c84ae99] {\n  color: var(--color-text-maxcontrast);\n}\n",""]);const l=o},4330:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(1601),i=a.n(n),r=a(6314),o=a.n(r)()(i());o.push([e.id,"\n.metavox-icon[data-v-2e54ffd2] {\n  display: inline-flex;\n  align-self: center;\n}\n.metavox-icon svg[data-v-2e54ffd2] {\n  fill: currentColor;\n}\n",""]);const l=o},6069:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ze});var n=a(641),i=a(33),r=a(3751);const o={key:0,class:"loading"},l={key:1,class:"error-message"},s={key:2,class:"metadata-container"},d={class:"metadata-row"},c={class:"metadata-label"},p={class:"metadata-value metadata-editable"},v={class:"metadata-row"},h={class:"metadata-label"},m={class:"metadata-value"},g={class:"metadata-hint"},u={class:"metadata-row"},f={class:"metadata-label"},b={class:"metadata-value metadata-path"},x=["href"],y={key:0,class:"metadata-row"},k={class:"metadata-label"},w={class:"metadata-value"},C={key:0,class:"metadata-hint"},T={key:1,class:"metadata-row"},V={class:"metadata-label"},L={class:"metadata-value metadata-monospace"},E={ref:"metavoxContainer",class:"metavox-container"},A={key:0,class:"loading"},I={key:1,class:"empty-state"};var _=a(3334),M=a(3814),$=a(6802),z=a(5168),X=a(5873);const R=["aria-hidden","aria-label"],Q=["fill","width","height"],N={d:"M13.5,8H12V13L16.28,15.54L17,14.33L13.5,12.25V8M13,3A9,9 0 0,0 4,12H1L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3"},S={key:0},F={name:"HistoryIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var D=a(6262);const H=(0,D.A)(F,[["render",function(e,t,a,r,o,l){return(0,n.uX)(),(0,n.CE)("span",(0,n.v6)(e.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon history-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[((0,n.uX)(),(0,n.CE)("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[(0,n.Lk)("path",N,[a.title?((0,n.uX)(),(0,n.CE)("title",S,(0,i.v_)(a.title),1)):(0,n.Q3)("v-if",!0)])],8,Q))],16,R)}]]),P=["aria-hidden","aria-label"],B=["fill","width","height"],U={d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z"},W={key:0},J={name:"InformationOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},O=(0,D.A)(J,[["render",function(e,t,a,r,o,l){return(0,n.uX)(),(0,n.CE)("span",(0,n.v6)(e.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon information-outline-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[((0,n.uX)(),(0,n.CE)("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[(0,n.Lk)("path",U,[a.title?((0,n.uX)(),(0,n.CE)("title",W,(0,i.v_)(a.title),1)):(0,n.Q3)("v-if",!0)])],8,B))],16,P)}]]),q=["aria-hidden","aria-label"],j=["fill","width","height"],Z={d:"M13,3A9,9 0 0,0 4,12H1L4.89,15.89L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3Z"},K={key:0},G={name:"RestoreIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Y=(0,D.A)(G,[["render",function(e,t,a,r,o,l){return(0,n.uX)(),(0,n.CE)("span",(0,n.v6)(e.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon restore-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[((0,n.uX)(),(0,n.CE)("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[(0,n.Lk)("path",Z,[a.title?((0,n.uX)(),(0,n.CE)("title",K,(0,i.v_)(a.title),1)):(0,n.Q3)("v-if",!0)])],8,j))],16,q)}]]),ee=["aria-hidden","aria-label"],te=["fill","width","height"],ae={d:"M17.63,5.84C17.27,5.33 16.67,5 16,5H5A2,2 0 0,0 3,7V17A2,2 0 0,0 5,19H16C16.67,19 17.27,18.66 17.63,18.15L22,12L17.63,5.84Z"},ne={key:0},ie={name:"LabelIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},re=(0,D.A)(ie,[["render",function(e,t,a,r,o,l){return(0,n.uX)(),(0,n.CE)("span",(0,n.v6)(e.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon label-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[((0,n.uX)(),(0,n.CE)("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[(0,n.Lk)("path",ae,[a.title?((0,n.uX)(),(0,n.CE)("title",ne,(0,i.v_)(a.title),1)):(0,n.Q3)("v-if",!0)])],8,te))],16,ee)}]]),oe=["aria-hidden","aria-label"],le=["fill","width","height"],se={d:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},de={key:0},ce={name:"AlertCircleIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},pe=(0,D.A)(ce,[["render",function(e,t,a,r,o,l){return(0,n.uX)(),(0,n.CE)("span",(0,n.v6)(e.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon alert-circle-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[((0,n.uX)(),(0,n.CE)("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[(0,n.Lk)("path",se,[a.title?((0,n.uX)(),(0,n.CE)("title",de,(0,i.v_)(a.title),1)):(0,n.Q3)("v-if",!0)])],8,le))],16,oe)}]]),ve={class:"material-design-icon metavox-icon"},he=["width","height"],me={name:"MetaVoxIcon",props:{size:{type:Number,default:24}}};var ge=a(5072),ue=a.n(ge),fe=a(7825),be=a.n(fe),xe=a(7659),ye=a.n(xe),ke=a(5056),we=a.n(ke),Ce=a(540),Te=a.n(Ce),Ve=a(1113),Le=a.n(Ve),Ee=a(4330),Ae={};Ae.styleTagTransform=Le(),Ae.setAttributes=we(),Ae.insert=ye().bind(null,"head"),Ae.domAPI=be(),Ae.insertStyleElement=Te(),ue()(Ee.A,Ae),Ee.A&&Ee.A.locals&&Ee.A.locals;const Ie=(0,D.A)(me,[["render",function(e,t,a,i,r,o){return(0,n.uX)(),(0,n.CE)("span",ve,[((0,n.uX)(),(0,n.CE)("svg",{viewBox:"0 0 24 24",width:a.size,height:a.size},[...t[0]||(t[0]=[(0,n.Lk)("path",{d:"M0 0 C2.45685425 0.42359556 3.6964912 0.65510363 5.375 2.5625 C7.01309099 4.27469613 7.01309099 4.27469613 9.9375 4.4375 C13.65445502 3.90650643 14.5402558 2.7142005 17 0 C17.99 0 18.98 0 20 0 C20.93405225 4.35891051 20.81144268 7.63849557 20 12 C20.33 12.33 20.66 12.66 21 13 C21.04080783 14.99958364 21.04254356 17.00045254 21 19 C19.576875 19.680625 19.576875 19.680625 18.125 20.375 C14.99686321 21.80238254 14.99686321 21.80238254 13 24 C9.12472131 24.51670383 7.52342441 24.37735248 4.3125 22.0625 C3.549375 21.381875 2.78625 20.70125 2 20 C1.01 19.67 0.02 19.34 -1 19 C-1.125 13.25 -1.125 13.25 0 11 C-0.25556108 8.98745646 -0.51448107 6.97446167 -0.84375 4.97265625 C-1 3 -1 3 0 0 Z",fill:"currentColor",transform:"translate(2,0)"},null,-1)])],8,he))])}],["__scopeId","data-v-2e54ffd2"]]),_e={name:"PageDetailsSidebar",components:{NcAppSidebar:X.Jx,NcAppSidebarTab:X.Gl,NcButton:X.x1,NcDialog:X.i$,NcEmptyContent:X.yI,NcLoadingIcon:X.ne,NcTextField:X.v,History:H,InformationOutline:O,MetaVoxIcon:Ie,Restore:Y,Label:re,AlertCircle:pe},props:{isOpen:{type:Boolean,default:!1},pageId:{type:String,required:!0},pageName:{type:String,default:""},initialTab:{type:String,default:"details-tab"}},emits:["close","version-restored","version-selected"],data:()=>({activeTab:"details-tab",versions:[],loadingVersions:!1,versionError:null,restoringVersion:!1,showRestoreDialog:!1,versionToRestore:null,metadata:null,loadingMetadata:!1,metadataError:null,editingTitle:!1,editableTitle:"",savingTitle:!1,metaVoxInstalled:!1,loadingMetaVox:!1,selectedVersion:null,editingLabel:null,editableLabel:"",isRestoring:!1,versionsLoaded:!1}),computed:{pageSubtitle(){return this.t("Page details and history")},canEditTitle(){return this.metadata?.permissions?.canWrite??this.metadata?.canEdit??!1}},watch:{isOpen(e){e&&(this.versionsLoaded=!1,this.loadMetadata().catch(()=>{}),this.checkMetaVoxInstalled())},pageId(){this.isOpen&&(this.versionsLoaded=!1,this.loadMetadata().catch(()=>{}),this.dispatchMetaVoxUpdate())},initialTab(e){e&&e!==this.activeTab&&(this.activeTab=e)},activeTab(e){"versions-tab"!==e||this.versionsLoaded?"metavox-tab"===e&&this.metaVoxInstalled&&this.$nextTick(()=>{this.dispatchMetaVoxUpdate()}):this.loadVersions().then(()=>{this.versionsLoaded=!0}).catch(()=>{}),"versions-tab"===e&&this.versions.length>0&&!this.selectedVersion&&this.autoSelectFirstVersion()},versions(e){"versions-tab"===this.activeTab&&e.length>0&&!this.isRestoring&&!this.selectedVersion&&this.autoSelectFirstVersion()},metaVoxInstalled(e){e&&"metavox-tab"===this.activeTab&&this.$nextTick(()=>{this.dispatchMetaVoxUpdate()})}},mounted(){this.isOpen&&(this.loadMetadata().catch(()=>{}),this.checkMetaVoxInstalled())},methods:{t:(e,t={})=>(0,_.Tl)("intravox",e,t),handleClose(){this.$emit("close")},getDisplayPath(e){if(!e)return"";const t=e.lastIndexOf("/"),a=t>0?e.substring(0,t):e,n=this.metadata?.mountPoint||"IntraVox";if(a.startsWith("/__groupfolders/")){const e=a.replace(/^\/__groupfolders\/\d+\//,"").replace(/^files\//,"");return e?`${n}/${e}`:n}const i=new RegExp(`^/[^/]+/files/${n}/(.*)$`),r=a.match(i);if(r){const e=r[1];return e?`${n}/${e}`:n}return a},getFolderUrl(e){if(!e)return"#";const t=e.lastIndexOf("/"),a=t>0?e.substring(0,t):e,n=this.metadata?.mountPoint||"IntraVox",i=this.metadata?.parentFolderId;if(a.startsWith("/__groupfolders/")){const e=a.replace(/^\/__groupfolders\/\d+\//,"").replace(/^files\//,"");if(!i)return"#";const t=`/${n}/${e}`;return(0,M.Jv)("/apps/files/files/{fileId}?dir={dir}",{fileId:i,dir:t})}const r=new RegExp(`^/[^/]+/files/${n}/(.*)$`),o=a.match(r);if(o){const e=o[1];if(!i)return"#";const t=e?`/${n}/${e}`:`/${n}`;return(0,M.Jv)("/apps/files/files/{fileId}?dir={dir}",{fileId:i,dir:t})}return(0,M.Jv)("/apps/files/?dir={dir}",{dir:a})},onTabChange(e){"metavox-tab"===e&&this.metaVoxInstalled&&this.$nextTick(()=>{this.dispatchMetaVoxUpdate()})},async loadVersions(){this.loadingVersions=!0,this.versionError=null;try{const e=(0,M.Jv)(`/apps/intravox/api/pages/${this.pageId}/versions`),t=await $.Ay.get(e);this.versions=t.data}catch(e){this.versionError=e.response?.data?.error||this.t("Failed to load version history")}finally{this.loadingVersions=!1}},confirmRestoreVersion(e){this.versionToRestore=e,this.showRestoreDialog=!0},cancelRestore(){this.showRestoreDialog=!1,this.versionToRestore=null},async restoreVersion(){if(!this.versionToRestore)return;this.restoringVersion=!0,this.isRestoring=!0,this.showRestoreDialog=!1;const e=this.versionToRestore;try{const t=(0,M.Jv)(`/apps/intravox/api/pages/${this.pageId}/versions/${this.versionToRestore}`),a=await $.Ay.post(t);this.$emit("version-restored",a.data),await this.loadVersions(),this.$nextTick(()=>{const t=this.versions.find(t=>t.timestamp===e);t?this.selectVersion(t):this.versions.length>1&&this.selectVersion(this.versions[1]),this.isRestoring=!1}),this.versionToRestore=null}catch(e){console.error("Failed to restore version:",e),(0,z.Qg)(this.t("Failed to restore version: {error}",{error:e.response?.data?.error||e.message})),this.isRestoring=!1}finally{this.restoringVersion=!1}},async loadMetadata(){this.loadingMetadata=!0,this.metadataError=null;try{const e=(0,M.Jv)(`/apps/intravox/api/pages/${this.pageId}/metadata`),t=await $.Ay.get(e);this.metadata=t.data}catch(e){console.error("Failed to load metadata:",e),this.metadataError=e.response?.data?.error||this.t("Failed to load properties")}finally{this.loadingMetadata=!1}},startTitleEdit(){(this.metadata?.permissions?.canWrite??this.metadata?.canEdit)&&(this.editableTitle=this.metadata.title,this.editingTitle=!0,this.$nextTick(()=>{const e=this.$el.querySelector(".title-input");e&&(e.focus(),e.select())}))},cancelTitleEdit(){this.editingTitle=!1,this.editableTitle=""},async saveTitle(){if(this.editableTitle.trim()){this.savingTitle=!0;try{const e=(0,M.Jv)(`/apps/intravox/api/pages/${this.pageId}/metadata`),t=await $.Ay.put(e,{title:this.editableTitle.trim()});this.metadata=t.data,this.editingTitle=!1,(0,z.Te)(this.t("Title updated"))}catch(e){console.error("Failed to update title:",e),(0,z.Qg)(this.t("Failed to update title: {error}",{error:e.response?.data?.error||e.message}))}finally{this.savingTitle=!1}}else(0,z.Qg)(this.t("Title cannot be empty"))},async checkMetaVoxInstalled(){try{const e=(0,M.Jv)("/apps/intravox/api/metavox/status"),t=await $.Ay.get(e);this.metaVoxInstalled=!0===t.data.installed}catch(e){this.metaVoxInstalled=!1}},dispatchMetaVoxUpdate(){if(!this.metaVoxInstalled)return;if(!this.$refs.metavoxContainer)return;const e=new CustomEvent("intravox:metavox:update",{detail:{pageId:this.pageId,pageName:this.pageName,container:this.$refs.metavoxContainer,metadata:this.metadata}});window.dispatchEvent(e)},formatBytes(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]},startLabelEdit(e){this.editingLabel=e.timestamp,this.editableLabel=e.label||""},cancelLabelEdit(){this.editingLabel=null,this.editableLabel=""},async saveVersionLabel(e){if(this.editableLabel.trim()||this.versions.find(t=>t.timestamp===e)?.label)try{const t=(0,M.Jv)(`/apps/intravox/api/pages/${this.pageId}/versions/${e}/label`);await $.Ay.put(t,{label:this.editableLabel.trim()});const a=this.versions.find(t=>t.timestamp===e);a&&(a.label=this.editableLabel.trim()||null),this.cancelLabelEdit(),(0,z.Te)(this.t("Version label updated"))}catch(e){(0,z.Qg)(this.t("Failed to update version label: {error}",{error:e.response?.data?.error||e.message}))}else this.cancelLabelEdit()},async selectVersion(e){this.selectedVersion=e,this.$emit("version-selected",{version:e,pageId:this.pageId})},getDepartmentMaxDepth:()=>2,getPageTypeLabel(e){return{department:this.t("Department"),container:this.t("Container"),page:this.t("Page")}[e]||e},autoSelectFirstVersion(){this.versions.length>0&&this.$nextTick(()=>{this.selectVersion(this.versions[0])})}}};var Me=a(1503),$e={};$e.styleTagTransform=Le(),$e.setAttributes=we(),$e.insert=ye().bind(null,"head"),$e.domAPI=be(),$e.insertStyleElement=Te(),ue()(Me.A,$e),Me.A&&Me.A.locals&&Me.A.locals;const ze=(0,D.A)(_e,[["render",function(e,t,a,_,M,$){const z=(0,n.g2)("InformationOutline"),X=(0,n.g2)("NcButton"),R=(0,n.g2)("NcAppSidebarTab"),Q=(0,n.g2)("MetaVoxIcon"),N=((0,n.g2)("History"),(0,n.g2)("NcLoadingIcon"),(0,n.g2)("NcEmptyContent"),(0,n.g2)("AlertCircle"),(0,n.g2)("NcTextField"),(0,n.g2)("Label"),(0,n.g2)("Restore"),(0,n.g2)("NcAppSidebar")),S=(0,n.g2)("NcDialog");return(0,n.uX)(),(0,n.CE)(n.FK,null,[a.isOpen?((0,n.uX)(),(0,n.Wv)(N,{key:0,name:a.pageName,subtitle:$.pageSubtitle,active:M.activeTab,"onUpdate:active":$.onTabChange,onClose:$.handleClose},{default:(0,n.k6)(()=>[(0,n.Q3)(" Details Tab (Page Properties/File Info) "),(0,n.bF)(R,{id:"details-tab",name:$.t("Details"),order:1},{icon:(0,n.k6)(()=>[(0,n.bF)(z,{size:20})]),default:(0,n.k6)(()=>[M.loadingMetadata?((0,n.uX)(),(0,n.CE)("div",o,(0,i.v_)($.t("Loading properties...")),1)):M.metadataError?((0,n.uX)(),(0,n.CE)("div",l,(0,i.v_)(M.metadataError),1)):M.metadata?((0,n.uX)(),(0,n.CE)("div",s,[(0,n.Q3)(" Editable Title "),(0,n.Lk)("div",d,[(0,n.Lk)("label",c,(0,i.v_)($.t("Name")),1),(0,n.Lk)("div",p,[M.editingTitle?(0,n.bo)(((0,n.uX)(),(0,n.CE)("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=e=>M.editableTitle=e),type:"text",class:"title-input",onKeydown:[t[1]||(t[1]=(0,r.jR)((...e)=>$.saveTitle&&$.saveTitle(...e),["enter"])),t[2]||(t[2]=(0,r.jR)((...e)=>$.cancelTitleEdit&&$.cancelTitleEdit(...e),["esc"]))]},null,544)),[[r.Jo,M.editableTitle]]):((0,n.uX)(),(0,n.CE)("span",{key:1,class:(0,i.C4)(["metadata-text",{"metadata-text--editable":$.canEditTitle}]),onClick:t[3]||(t[3]=(...e)=>$.startTitleEdit&&$.startTitleEdit(...e))},(0,i.v_)(M.metadata.title||$.t("Untitled")),3)),M.editingTitle?((0,n.uX)(),(0,n.Wv)(X,{key:2,type:"primary",onClick:$.saveTitle,disabled:M.savingTitle,size:"small"},{default:(0,n.k6)(()=>[(0,n.eW)((0,i.v_)($.t("Save")),1)]),_:1},8,["onClick","disabled"])):(0,n.Q3)("v-if",!0),M.editingTitle?((0,n.uX)(),(0,n.Wv)(X,{key:3,type:"secondary",onClick:$.cancelTitleEdit,size:"small"},{default:(0,n.k6)(()=>[(0,n.eW)((0,i.v_)($.t("Cancel")),1)]),_:1},8,["onClick"])):(0,n.Q3)("v-if",!0)])]),(0,n.Q3)(" Modified "),(0,n.Lk)("div",v,[(0,n.Lk)("label",h,(0,i.v_)($.t("Modified")),1),(0,n.Lk)("div",m,[(0,n.eW)((0,i.v_)(M.metadata.modifiedRelative)+" ",1),(0,n.Lk)("span",g,(0,i.v_)(M.metadata.modifiedFormatted),1)])]),(0,n.Q3)(" Path "),(0,n.Lk)("div",u,[(0,n.Lk)("label",f,(0,i.v_)($.t("Location")),1),(0,n.Lk)("div",b,[(0,n.Lk)("a",{href:$.getFolderUrl(M.metadata.path),target:"_blank",rel:"noopener noreferrer",class:"folder-link"},(0,i.v_)($.getDisplayPath(M.metadata.path)),9,x)])]),(0,n.Q3)(" Page Type "),M.metadata.type?((0,n.uX)(),(0,n.CE)("div",y,[(0,n.Lk)("label",k,(0,i.v_)($.t("Type")),1),(0,n.Lk)("div",w,[(0,n.Lk)("span",{class:(0,i.C4)(["page-type-badge",`page-type-${M.metadata.type}`])},(0,i.v_)($.getPageTypeLabel(M.metadata.type)),3),M.metadata.hasChildren?((0,n.uX)(),(0,n.CE)("span",C,(0,i.v_)($.t("(has child pages)")),1)):(0,n.Q3)("v-if",!0)])])):(0,n.Q3)("v-if",!0),(0,n.Q3)(" Unique ID (for sharing) "),M.metadata.uniqueId?((0,n.uX)(),(0,n.CE)("div",T,[(0,n.Lk)("label",V,(0,i.v_)($.t("UniqueId")),1),(0,n.Lk)("div",L,(0,i.v_)(M.metadata.uniqueId),1)])):(0,n.Q3)("v-if",!0)])):(0,n.Q3)("v-if",!0)]),_:1},8,["name"]),(0,n.Q3)(" MetaVox Tab (only if MetaVox app is installed) "),M.metaVoxInstalled?((0,n.uX)(),(0,n.Wv)(R,{key:0,id:"metavox-tab",name:$.t("MetaVox"),order:2},{icon:(0,n.k6)(()=>[(0,n.bF)(Q,{size:20})]),default:(0,n.k6)(()=>[(0,n.Lk)("div",E,[M.loadingMetaVox?((0,n.uX)(),(0,n.CE)("div",A,(0,i.v_)($.t("Loading MetaVox...")),1)):M.metaVoxInstalled?(0,n.Q3)("v-if",!0):((0,n.uX)(),(0,n.CE)("div",I,[(0,n.Lk)("p",null,(0,i.v_)($.t("MetaVox app is not installed")),1)]))],512)]),_:1},8,["name"])):(0,n.Q3)("v-if",!0),(0,n.Q3)(" Versions Tab - Hidden for v1.0 "),(0,n.Q3)("v-if",!0)]),_:1},8,["name","subtitle","active","onUpdate:active","onClose"])):(0,n.Q3)("v-if",!0),(0,n.Q3)(" Restore Version Confirmation Dialog "),M.showRestoreDialog?((0,n.uX)(),(0,n.Wv)(S,{key:1,name:$.t("Restore Version"),message:$.t("A backup of the current version will be created before restoring. Do you want to continue?"),buttons:[{label:$.t("Cancel"),callback:$.cancelRestore},{label:$.t("Restore"),type:"primary",callback:$.restoreVersion}],onClose:$.cancelRestore},null,8,["name","message","buttons","onClose"])):(0,n.Q3)("v-if",!0)],64)}],["__scopeId","data-v-5c84ae99"]])}}]);