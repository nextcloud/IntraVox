"use strict";(self.webpackChunknextcloud_intravox=self.webpackChunknextcloud_intravox||[]).push([[430],{2507:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(1601),n=a.n(i),r=a(6314),s=a.n(r)()(n());s.push([e.id,"\n/* NcAppSidebar handles its own styling */\n.loading[data-v-401d4766],\n.empty-state[data-v-401d4766] {\n  text-align: center;\n  padding: 20px;\n  color: var(--color-text-maxcontrast);\n}\n.empty-state .hint[data-v-401d4766] {\n  font-size: 12px;\n  margin-top: 8px;\n}\n.error-message[data-v-401d4766] {\n  padding: 12px;\n  background: var(--color-error);\n  color: white;\n  border-radius: var(--border-radius);\n  margin-bottom: 12px;\n}\n.version-list[data-v-401d4766] {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n.version-item[data-v-401d4766] {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px;\n  background: var(--color-background-hover);\n  border-radius: var(--border-radius);\n  transition: background 0.2s, border-color 0.2s;\n  border: 2px solid transparent;\n  cursor: pointer;\n}\n.version-item[data-v-401d4766]:hover {\n  background: var(--color-background-dark);\n}\n.version-item--selected[data-v-401d4766] {\n  background: var(--color-primary-element-light);\n  border-color: var(--color-primary-element);\n}\n.version-info[data-v-401d4766] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n.version-header[data-v-401d4766] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex-wrap: wrap;\n}\n.version-name[data-v-401d4766] {\n  font-weight: 600;\n  font-size: 14px;\n}\n.version-author[data-v-401d4766] {\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n}\n.version-badge[data-v-401d4766] {\n  font-size: 11px;\n  font-weight: 600;\n  padding: 3px 10px;\n  border-radius: var(--border-radius-pill, 20px);\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n.version-badge--current[data-v-401d4766] {\n  background-color: var(--color-primary-element);\n  color: var(--color-primary-element-text, white);\n}\n\n/* Current version item styling */\n.version-item--current[data-v-401d4766] {\n  background: var(--color-primary-element-light);\n  border-color: var(--color-primary-element);\n}\n.version-item--current[data-v-401d4766]:hover {\n  background: var(--color-primary-element-light);\n}\n\n/* Version history label */\n.version-history-label[data-v-401d4766] {\n  font-size: 12px;\n  font-weight: 600;\n  color: var(--color-text-maxcontrast);\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  padding: 12px 0 8px 0;\n  margin-top: 4px;\n  border-top: 1px solid var(--color-border);\n}\n.version-details[data-v-401d4766] {\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n}\n.version-actions[data-v-401d4766] {\n  display: flex;\n  gap: 4px;\n  align-items: center;\n}\n\n/* Versions container */\n.versions-container[data-v-401d4766] {\n  min-height: 200px;\n  padding: 8px;\n}\n\n/* Metadata container */\n.metadata-container[data-v-401d4766] {\n  padding: 12px;\n}\n.metadata-row[data-v-401d4766] {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  padding: 12px 0;\n  border-bottom: 1px solid var(--color-border);\n}\n.metadata-row[data-v-401d4766]:last-child {\n  border-bottom: none;\n}\n.metadata-label[data-v-401d4766] {\n  font-size: 12px;\n  font-weight: 600;\n  color: var(--color-text-maxcontrast);\n}\n.metadata-value[data-v-401d4766] {\n  font-size: 14px;\n  color: var(--color-main-text);\n  word-break: break-word;\n}\n.metadata-hint[data-v-401d4766] {\n  display: block;\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n  margin-top: 2px;\n}\n.metadata-path[data-v-401d4766] {\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n}\n.folder-link[data-v-401d4766] {\n  color: var(--color-primary-element);\n  text-decoration: none;\n  border-bottom: 1px dotted var(--color-primary-element);\n  transition: border-bottom 0.2s;\n}\n.folder-link[data-v-401d4766]:hover {\n  border-bottom: 1px solid var(--color-primary-element);\n}\n.metadata-monospace[data-v-401d4766] {\n  font-family: monospace;\n  font-size: 12px;\n  background: var(--color-background-hover);\n  padding: 4px 8px;\n  border-radius: var(--border-radius);\n}\n.page-type-badge[data-v-401d4766] {\n  display: inline-block;\n  padding: 4px 12px;\n  border-radius: var(--border-radius-large);\n  font-size: 12px;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n.page-type-department[data-v-401d4766] {\n  background: #10b981;\n  color: white;\n}\n.page-type-container[data-v-401d4766] {\n  background: #3b82f6;\n  color: white;\n}\n.page-type-page[data-v-401d4766] {\n  background: var(--color-background-dark);\n  color: var(--color-main-text);\n}\n.metadata-editable[data-v-401d4766] {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n.metadata-text[data-v-401d4766] {\n  padding: 4px;\n  border-radius: var(--border-radius);\n  transition: background 0.2s;\n}\n.metadata-text--editable[data-v-401d4766] {\n  cursor: pointer;\n}\n.metadata-text--editable[data-v-401d4766]:hover {\n  background: var(--color-background-hover);\n}\n.title-input[data-v-401d4766] {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid var(--color-border);\n  border-radius: var(--border-radius);\n  font-size: 14px;\n  background: var(--color-main-background);\n  color: var(--color-main-text);\n}\n.title-input[data-v-401d4766]:focus {\n  outline: none;\n  border-color: var(--color-primary-element);\n}\n.metadata-editable[data-v-401d4766] .button-vue {\n  margin-right: 8px;\n}\n\n/* MetaVox container */\n.metavox-container[data-v-401d4766] {\n  padding: 12px;\n  min-height: 200px;\n}\n",""]);const o=s},4330:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(1601),n=a.n(i),r=a(6314),s=a.n(r)()(n());s.push([e.id,"\n.metavox-icon[data-v-2e54ffd2] {\n  display: inline-flex;\n  align-self: center;\n}\n.metavox-icon svg[data-v-2e54ffd2] {\n  fill: currentColor;\n}\n",""]);const o=s},5430:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Pe});var i=a(641),n=a(33),r=a(3751);const s={key:0,class:"loading"},o={key:1,class:"error-message"},l={key:2,class:"metadata-container"},d={class:"metadata-row"},c={class:"metadata-label"},v={class:"metadata-value metadata-editable"},p={class:"metadata-row"},h={class:"metadata-label"},m={class:"metadata-value"},u={class:"metadata-hint"},g={class:"metadata-row"},b={class:"metadata-label"},f={class:"metadata-value metadata-path"},x=["href"],y={key:0,class:"metadata-row"},k={class:"metadata-label"},C={class:"metadata-value"},V={key:0,class:"metadata-hint"},L={key:1,class:"metadata-row"},T={class:"metadata-label"},E={class:"metadata-value metadata-monospace"},w={ref:"metavoxContainer",class:"metavox-container"},_={key:0,class:"loading"},I={key:1,class:"empty-state"},A={class:"versions-container"},M={key:0,class:"loading"},$={key:1,class:"error-message"},z={key:2,class:"empty-state"},R={class:"hint"},X={key:3,class:"version-list"},S={class:"version-info"},Q={class:"version-header"},F={class:"version-name"},D={key:0,class:"version-author"},N={class:"version-details"},P={key:0},B={class:"version-history-label"},U=["onClick"],W={class:"version-info"},H={class:"version-header"},J={class:"version-name"},O={key:0,class:"version-author"},q={class:"version-details"},j={class:"version-actions"};var K=a(3334),G=a(3814),Z=a(6802),Y=a(5168),ee=a(5873);const te=["aria-hidden","aria-label"],ae=["fill","width","height"],ie={d:"M13.5,8H12V13L16.28,15.54L17,14.33L13.5,12.25V8M13,3A9,9 0 0,0 4,12H1L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3"},ne={key:0},re={name:"HistoryIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var se=a(6262);const oe=(0,se.A)(re,[["render",function(e,t,a,r,s,o){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon history-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",ie,[a.title?((0,i.uX)(),(0,i.CE)("title",ne,(0,n.v_)(a.title),1)):(0,i.Q3)("v-if",!0)])],8,ae))],16,te)}]]),le=["aria-hidden","aria-label"],de=["fill","width","height"],ce={d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z"},ve={key:0},pe={name:"InformationOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},he=(0,se.A)(pe,[["render",function(e,t,a,r,s,o){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon information-outline-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",ce,[a.title?((0,i.uX)(),(0,i.CE)("title",ve,(0,n.v_)(a.title),1)):(0,i.Q3)("v-if",!0)])],8,de))],16,le)}]]),me=["aria-hidden","aria-label"],ue=["fill","width","height"],ge={d:"M13,3A9,9 0 0,0 4,12H1L4.89,15.89L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3Z"},be={key:0},fe={name:"RestoreIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},xe=(0,se.A)(fe,[["render",function(e,t,a,r,s,o){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon restore-icon",role:"img",onClick:t[0]||(t[0]=t=>e.$emit("click",t))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",ge,[a.title?((0,i.uX)(),(0,i.CE)("title",be,(0,n.v_)(a.title),1)):(0,i.Q3)("v-if",!0)])],8,ue))],16,me)}]]),ye={class:"material-design-icon metavox-icon"},ke=["width","height"],Ce={name:"MetaVoxIcon",props:{size:{type:Number,default:24}}};var Ve=a(5072),Le=a.n(Ve),Te=a(7825),Ee=a.n(Te),we=a(7659),_e=a.n(we),Ie=a(5056),Ae=a.n(Ie),Me=a(540),$e=a.n(Me),ze=a(1113),Re=a.n(ze),Xe=a(4330),Se={};Se.styleTagTransform=Re(),Se.setAttributes=Ae(),Se.insert=_e().bind(null,"head"),Se.domAPI=Ee(),Se.insertStyleElement=$e(),Le()(Xe.A,Se),Xe.A&&Xe.A.locals&&Xe.A.locals;const Qe=(0,se.A)(Ce,[["render",function(e,t,a,n,r,s){return(0,i.uX)(),(0,i.CE)("span",ye,[((0,i.uX)(),(0,i.CE)("svg",{viewBox:"0 0 24 24",width:a.size,height:a.size},[...t[0]||(t[0]=[(0,i.Lk)("path",{d:"M0 0 C2.45685425 0.42359556 3.6964912 0.65510363 5.375 2.5625 C7.01309099 4.27469613 7.01309099 4.27469613 9.9375 4.4375 C13.65445502 3.90650643 14.5402558 2.7142005 17 0 C17.99 0 18.98 0 20 0 C20.93405225 4.35891051 20.81144268 7.63849557 20 12 C20.33 12.33 20.66 12.66 21 13 C21.04080783 14.99958364 21.04254356 17.00045254 21 19 C19.576875 19.680625 19.576875 19.680625 18.125 20.375 C14.99686321 21.80238254 14.99686321 21.80238254 13 24 C9.12472131 24.51670383 7.52342441 24.37735248 4.3125 22.0625 C3.549375 21.381875 2.78625 20.70125 2 20 C1.01 19.67 0.02 19.34 -1 19 C-1.125 13.25 -1.125 13.25 0 11 C-0.25556108 8.98745646 -0.51448107 6.97446167 -0.84375 4.97265625 C-1 3 -1 3 0 0 Z",fill:"currentColor",transform:"translate(2,0)"},null,-1)])],8,ke))])}],["__scopeId","data-v-2e54ffd2"]]),Fe={name:"PageDetailsSidebar",components:{NcAppSidebar:ee.Jx,NcAppSidebarTab:ee.Gl,NcButton:ee.x1,NcDialog:ee.i$,History:oe,InformationOutline:he,MetaVoxIcon:Qe,Restore:xe},props:{isOpen:{type:Boolean,default:!1},pageId:{type:String,required:!0},pageName:{type:String,default:""},initialTab:{type:String,default:"details-tab"}},emits:["close","version-restored","version-selected"],data:()=>({activeTab:"details-tab",versions:[],currentVersion:null,loadingVersions:!1,versionError:null,restoringVersion:!1,showRestoreDialog:!1,versionToRestore:null,metadata:null,loadingMetadata:!1,metadataError:null,editingTitle:!1,editableTitle:"",savingTitle:!1,metaVoxInstalled:!1,loadingMetaVox:!1,selectedVersion:null,editingLabel:null,editableLabel:"",isRestoring:!1,versionsLoaded:!1}),computed:{pageSubtitle(){return this.t("Page details and history")},canEditTitle(){return this.metadata?.permissions?.canWrite??this.metadata?.canEdit??!1},currentVersionDate(){return this.currentVersion?.relativeTime?this.currentVersion.relativeTime:this.metadata?.modifiedRelative?this.metadata.modifiedRelative:this.t("Now")},currentVersionSize(){return this.currentVersion?.size?this.formatBytes(this.currentVersion.size):null},currentVersionAuthor(){return this.currentVersion?.author||null}},watch:{isOpen(e,t){e&&!t&&(this.versionsLoaded=!1,this.activeTab=this.initialTab||"details-tab",this.loadMetadata().catch(()=>{}),this.checkMetaVoxInstalled())},pageId(){this.isOpen&&(this.versionsLoaded=!1,this.loadMetadata().catch(()=>{}),this.dispatchMetaVoxUpdate())},initialTab(e){!this.isOpen&&e&&(this.activeTab=e)},activeTab(e){"versions-tab"!==e||this.versionsLoaded?"metavox-tab"===e&&this.metaVoxInstalled&&this.$nextTick(()=>{this.dispatchMetaVoxUpdate()}):(this.loadVersions(),this.versionsLoaded=!0)},versions(e){"versions-tab"===this.activeTab&&e.length>0&&!this.isRestoring&&!this.selectedVersion&&this.autoSelectFirstVersion()},metaVoxInstalled(e){e&&"metavox-tab"===this.activeTab&&this.$nextTick(()=>{this.dispatchMetaVoxUpdate()})}},mounted(){this.isOpen&&(this.loadMetadata().catch(()=>{}),this.checkMetaVoxInstalled()),window.addEventListener("intravox:page:saved",this.handlePageSaved),window.addEventListener("intravox:edit:started",this.handleEditStarted)},beforeUnmount(){window.removeEventListener("intravox:page:saved",this.handlePageSaved),window.removeEventListener("intravox:edit:started",this.handleEditStarted)},methods:{t:(e,t={})=>(0,K.Tl)("intravox",e,t),handleClose(){this.$emit("close")},getDisplayPath(e){if(!e)return"";const t=e.lastIndexOf("/"),a=t>0?e.substring(0,t):e,i=this.metadata?.mountPoint||"IntraVox";if(a.startsWith("/__groupfolders/")){const e=a.replace(/^\/__groupfolders\/\d+\//,"").replace(/^files\//,"");return e?`${i}/${e}`:i}const n=new RegExp(`^/[^/]+/files/${i}/(.*)$`),r=a.match(n);if(r){const e=r[1];return e?`${i}/${e}`:i}return a},getFolderUrl(e){if(!e)return"#";const t=e.lastIndexOf("/"),a=t>0?e.substring(0,t):e,i=this.metadata?.mountPoint||"IntraVox",n=this.metadata?.parentFolderId;if(a.startsWith("/__groupfolders/")){const e=a.replace(/^\/__groupfolders\/\d+\//,"").replace(/^files\//,"");if(!n)return"#";const t=`/${i}/${e}`;return(0,G.Jv)("/apps/files/files/{fileId}?dir={dir}",{fileId:n,dir:t})}const r=new RegExp(`^/[^/]+/files/${i}/(.*)$`),s=a.match(r);if(s){const e=s[1];if(!n)return"#";const t=e?`/${i}/${e}`:`/${i}`;return(0,G.Jv)("/apps/files/files/{fileId}?dir={dir}",{fileId:n,dir:t})}return(0,G.Jv)("/apps/files/?dir={dir}",{dir:a})},onTabChange(e){"versions-tab"!==e||this.versionsLoaded?"metavox-tab"===e&&this.metaVoxInstalled&&this.$nextTick(()=>{this.dispatchMetaVoxUpdate()}):(this.loadVersions(),this.versionsLoaded=!0)},async loadVersions(){this.loadingVersions=!0,this.versionError=null;try{const e=(0,G.Jv)(`/apps/intravox/api/pages/${this.pageId}/versions`),t=await Z.Ay.get(e);t.data&&"object"==typeof t.data&&"versions"in t.data?(this.currentVersion=t.data.currentVersion,this.versions=t.data.versions):(this.versions=t.data,this.currentVersion=null)}catch(e){console.error("Failed to load versions:",e),this.versionError=e.response?.data?.error||this.t("Failed to load version history")}finally{this.loadingVersions=!1}},confirmRestoreVersion(e){this.versionToRestore=e,this.showRestoreDialog=!0},cancelRestore(){this.showRestoreDialog=!1,this.versionToRestore=null},async restoreVersion(){if(!this.versionToRestore)return;this.restoringVersion=!0,this.isRestoring=!0,this.showRestoreDialog=!1;const e=this.versionToRestore;try{const t=(0,G.Jv)(`/apps/intravox/api/pages/${this.pageId}/versions/${this.versionToRestore}`),a=await Z.Ay.post(t);this.$emit("version-restored",a.data),await this.loadVersions(),this.$nextTick(()=>{const t=this.versions.find(t=>t.timestamp===e);t?this.selectVersion(t):this.versions.length>1&&this.selectVersion(this.versions[1]),this.isRestoring=!1}),this.versionToRestore=null}catch(e){console.error("Failed to restore version:",e),(0,Y.Qg)(this.t("Failed to restore version: {error}",{error:e.response?.data?.error||e.message})),this.isRestoring=!1}finally{this.restoringVersion=!1}},async loadMetadata(){this.loadingMetadata=!0,this.metadataError=null;try{const e=(0,G.Jv)(`/apps/intravox/api/pages/${this.pageId}/metadata`),t=await Z.Ay.get(e);this.metadata=t.data}catch(e){console.error("Failed to load metadata:",e),this.metadataError=e.response?.data?.error||this.t("Failed to load properties")}finally{this.loadingMetadata=!1}},startTitleEdit(){(this.metadata?.permissions?.canWrite??this.metadata?.canEdit)&&(this.editableTitle=this.metadata.title,this.editingTitle=!0,this.$nextTick(()=>{const e=this.$el.querySelector(".title-input");e&&(e.focus(),e.select())}))},cancelTitleEdit(){this.editingTitle=!1,this.editableTitle=""},async saveTitle(){if(this.editableTitle.trim()){this.savingTitle=!0;try{const e=(0,G.Jv)(`/apps/intravox/api/pages/${this.pageId}/metadata`),t=await Z.Ay.put(e,{title:this.editableTitle.trim()});this.metadata=t.data,this.editingTitle=!1,(0,Y.Te)(this.t("Title updated"))}catch(e){console.error("Failed to update title:",e),(0,Y.Qg)(this.t("Failed to update title: {error}",{error:e.response?.data?.error||e.message}))}finally{this.savingTitle=!1}}else(0,Y.Qg)(this.t("Title cannot be empty"))},async checkMetaVoxInstalled(){try{const e=(0,G.Jv)("/apps/intravox/api/metavox/status"),t=await Z.Ay.get(e);this.metaVoxInstalled=!0===t.data.installed}catch(e){this.metaVoxInstalled=!1}},dispatchMetaVoxUpdate(){if(!this.metaVoxInstalled)return;if(!this.$refs.metavoxContainer)return;const e=new CustomEvent("intravox:metavox:update",{detail:{pageId:this.pageId,pageName:this.pageName,container:this.$refs.metavoxContainer,metadata:this.metadata}});window.dispatchEvent(e)},formatBytes(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]},startLabelEdit(e){this.editingLabel=e.timestamp,this.editableLabel=e.label||""},cancelLabelEdit(){this.editingLabel=null,this.editableLabel=""},async saveVersionLabel(e){if(this.editableLabel.trim()||this.versions.find(t=>t.timestamp===e)?.label)try{const t=(0,G.Jv)(`/apps/intravox/api/pages/${this.pageId}/versions/${e}/label`);await Z.Ay.put(t,{label:this.editableLabel.trim()});const a=this.versions.find(t=>t.timestamp===e);a&&(a.label=this.editableLabel.trim()||null),this.cancelLabelEdit(),(0,Y.Te)(this.t("Version label updated"))}catch(e){(0,Y.Qg)(this.t("Failed to update version label: {error}",{error:e.response?.data?.error||e.message}))}else this.cancelLabelEdit()},selectCurrentVersion(){this.selectedVersion=null,this.$emit("version-selected",{version:null,pageId:this.pageId})},async selectVersion(e){this.selectedVersion=e,this.$emit("version-selected",{version:e,pageId:this.pageId})},getDepartmentMaxDepth:()=>2,getPageTypeLabel(e){return{department:this.t("Department"),container:this.t("Container"),page:this.t("Page")}[e]||e},autoSelectFirstVersion(){this.$nextTick(()=>{this.selectCurrentVersion()})},handlePageSaved(e){e.detail?.pageId===this.pageId&&this.versionsLoaded&&this.loadVersions()},handleEditStarted(e){e.detail?.pageId===this.pageId&&this.selectCurrentVersion()}}};var De=a(2507),Ne={};Ne.styleTagTransform=Re(),Ne.setAttributes=Ae(),Ne.insert=_e().bind(null,"head"),Ne.domAPI=Ee(),Ne.insertStyleElement=$e(),Le()(De.A,Ne),De.A&&De.A.locals&&De.A.locals;const Pe=(0,se.A)(Fe,[["render",function(e,t,a,K,G,Z){const Y=(0,i.g2)("InformationOutline"),ee=(0,i.g2)("NcButton"),te=(0,i.g2)("NcAppSidebarTab"),ae=(0,i.g2)("MetaVoxIcon"),ie=(0,i.g2)("History"),ne=(0,i.g2)("Restore"),re=(0,i.g2)("NcAppSidebar"),se=(0,i.g2)("NcDialog");return(0,i.uX)(),(0,i.CE)(i.FK,null,[a.isOpen?((0,i.uX)(),(0,i.Wv)(re,{key:0,name:a.pageName,subtitle:Z.pageSubtitle,active:G.activeTab,"onUpdate:active":Z.onTabChange,onClose:Z.handleClose},{default:(0,i.k6)(()=>[(0,i.Q3)(" Details Tab (Page Properties/File Info) "),(0,i.bF)(te,{id:"details-tab",name:Z.t("Details"),order:1},{icon:(0,i.k6)(()=>[(0,i.bF)(Y,{size:20})]),default:(0,i.k6)(()=>[G.loadingMetadata?((0,i.uX)(),(0,i.CE)("div",s,(0,n.v_)(Z.t("Loading properties...")),1)):G.metadataError?((0,i.uX)(),(0,i.CE)("div",o,(0,n.v_)(G.metadataError),1)):G.metadata?((0,i.uX)(),(0,i.CE)("div",l,[(0,i.Q3)(" Editable Title "),(0,i.Lk)("div",d,[(0,i.Lk)("label",c,(0,n.v_)(Z.t("Name")),1),(0,i.Lk)("div",v,[G.editingTitle?(0,i.bo)(((0,i.uX)(),(0,i.CE)("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=e=>G.editableTitle=e),type:"text",class:"title-input",onKeydown:[t[1]||(t[1]=(0,r.jR)((...e)=>Z.saveTitle&&Z.saveTitle(...e),["enter"])),t[2]||(t[2]=(0,r.jR)((...e)=>Z.cancelTitleEdit&&Z.cancelTitleEdit(...e),["esc"]))]},null,544)),[[r.Jo,G.editableTitle]]):((0,i.uX)(),(0,i.CE)("span",{key:1,class:(0,n.C4)(["metadata-text",{"metadata-text--editable":Z.canEditTitle}]),onClick:t[3]||(t[3]=(...e)=>Z.startTitleEdit&&Z.startTitleEdit(...e))},(0,n.v_)(G.metadata.title||Z.t("Untitled")),3)),G.editingTitle?((0,i.uX)(),(0,i.Wv)(ee,{key:2,type:"primary",onClick:Z.saveTitle,disabled:G.savingTitle,size:"small"},{default:(0,i.k6)(()=>[(0,i.eW)((0,n.v_)(Z.t("Save")),1)]),_:1},8,["onClick","disabled"])):(0,i.Q3)("v-if",!0),G.editingTitle?((0,i.uX)(),(0,i.Wv)(ee,{key:3,type:"secondary",onClick:Z.cancelTitleEdit,size:"small"},{default:(0,i.k6)(()=>[(0,i.eW)((0,n.v_)(Z.t("Cancel")),1)]),_:1},8,["onClick"])):(0,i.Q3)("v-if",!0)])]),(0,i.Q3)(" Modified "),(0,i.Lk)("div",p,[(0,i.Lk)("label",h,(0,n.v_)(Z.t("Modified")),1),(0,i.Lk)("div",m,[(0,i.eW)((0,n.v_)(G.metadata.modifiedRelative)+" ",1),(0,i.Lk)("span",u,(0,n.v_)(G.metadata.modifiedFormatted),1)])]),(0,i.Q3)(" Path "),(0,i.Lk)("div",g,[(0,i.Lk)("label",b,(0,n.v_)(Z.t("Location")),1),(0,i.Lk)("div",f,[(0,i.Lk)("a",{href:Z.getFolderUrl(G.metadata.path),target:"_blank",rel:"noopener noreferrer",class:"folder-link"},(0,n.v_)(Z.getDisplayPath(G.metadata.path)),9,x)])]),(0,i.Q3)(" Page Type "),G.metadata.type?((0,i.uX)(),(0,i.CE)("div",y,[(0,i.Lk)("label",k,(0,n.v_)(Z.t("Type")),1),(0,i.Lk)("div",C,[(0,i.Lk)("span",{class:(0,n.C4)(["page-type-badge",`page-type-${G.metadata.type}`])},(0,n.v_)(Z.getPageTypeLabel(G.metadata.type)),3),G.metadata.hasChildren?((0,i.uX)(),(0,i.CE)("span",V,(0,n.v_)(Z.t("(has child pages)")),1)):(0,i.Q3)("v-if",!0)])])):(0,i.Q3)("v-if",!0),(0,i.Q3)(" Unique ID (for sharing) "),G.metadata.uniqueId?((0,i.uX)(),(0,i.CE)("div",L,[(0,i.Lk)("label",T,(0,n.v_)(Z.t("UniqueId")),1),(0,i.Lk)("div",E,(0,n.v_)(G.metadata.uniqueId),1)])):(0,i.Q3)("v-if",!0)])):(0,i.Q3)("v-if",!0)]),_:1},8,["name"]),(0,i.Q3)(" MetaVox Tab (only if MetaVox app is installed) "),G.metaVoxInstalled?((0,i.uX)(),(0,i.Wv)(te,{key:0,id:"metavox-tab",name:Z.t("MetaVox"),order:2},{icon:(0,i.k6)(()=>[(0,i.bF)(ae,{size:20})]),default:(0,i.k6)(()=>[(0,i.Lk)("div",w,[G.loadingMetaVox?((0,i.uX)(),(0,i.CE)("div",_,(0,n.v_)(Z.t("Loading MetaVox...")),1)):G.metaVoxInstalled?(0,i.Q3)("v-if",!0):((0,i.uX)(),(0,i.CE)("div",I,[(0,i.Lk)("p",null,(0,n.v_)(Z.t("MetaVox app is not installed")),1)]))],512)]),_:1},8,["name"])):(0,i.Q3)("v-if",!0),(0,i.Q3)(" Versions Tab - Uses IntraVox versions API (leverages Nextcloud/GroupFolders versioning) "),(0,i.bF)(te,{id:"versions-tab",name:Z.t("Versions"),order:3},{icon:(0,i.k6)(()=>[(0,i.bF)(ie,{size:20})]),default:(0,i.k6)(()=>[(0,i.Lk)("div",A,[G.loadingVersions?((0,i.uX)(),(0,i.CE)("div",M,(0,n.v_)(Z.t("Loading versions...")),1)):G.versionError?((0,i.uX)(),(0,i.CE)("div",$,(0,n.v_)(G.versionError),1)):0===G.versions.length?((0,i.uX)(),(0,i.CE)("div",z,[(0,i.Lk)("p",null,(0,n.v_)(Z.t("No versions available")),1),(0,i.Lk)("p",R,(0,n.v_)(Z.t("Versions are created automatically when you save changes")),1)])):((0,i.uX)(),(0,i.CE)("div",X,[(0,i.Q3)(" Current version (the actual file, not from history) - like Nextcloud Files app "),(0,i.Lk)("div",{class:(0,n.C4)(["version-item version-item--current",{"version-item--selected":null===G.selectedVersion}]),onClick:t[4]||(t[4]=(...e)=>Z.selectCurrentVersion&&Z.selectCurrentVersion(...e))},[(0,i.Lk)("div",S,[(0,i.Lk)("div",Q,[(0,i.Lk)("span",F,(0,n.v_)(Z.t("Current version")),1),Z.currentVersionAuthor?((0,i.uX)(),(0,i.CE)("span",D,(0,n.v_)(Z.currentVersionAuthor),1)):(0,i.Q3)("v-if",!0)]),(0,i.Lk)("div",N,[(0,i.eW)((0,n.v_)(Z.currentVersionDate),1),Z.currentVersionSize?((0,i.uX)(),(0,i.CE)("span",P," · "+(0,n.v_)(Z.currentVersionSize),1)):(0,i.Q3)("v-if",!0)])])],2),(0,i.Q3)(" Version history "),(0,i.Lk)("div",B,(0,n.v_)(Z.t("Version history")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(G.versions,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.timestamp,class:(0,n.C4)(["version-item",{"version-item--selected":G.selectedVersion?.timestamp===e.timestamp}]),onClick:t=>Z.selectVersion(e)},[(0,i.Lk)("div",W,[(0,i.Lk)("div",H,[(0,i.Lk)("span",J,(0,n.v_)(e.label||Z.t("Version")),1),e.author?((0,i.uX)(),(0,i.CE)("span",O,(0,n.v_)(e.author),1)):(0,i.Q3)("v-if",!0)]),(0,i.Lk)("div",q,(0,n.v_)(e.relativeTime||e.formattedDate)+" · "+(0,n.v_)(Z.formatBytes(e.size)),1)]),(0,i.Lk)("div",j,[(0,i.bF)(ee,{type:"tertiary","aria-label":Z.t("Restore this version"),title:Z.t("Restore this version"),onClick:(0,r.D$)(t=>Z.confirmRestoreVersion(e.timestamp),["stop"])},{icon:(0,i.k6)(()=>[(0,i.bF)(ne,{size:20})]),_:1},8,["aria-label","title","onClick"])])],10,U))),128))]))])]),_:1},8,["name"])]),_:1},8,["name","subtitle","active","onUpdate:active","onClose"])):(0,i.Q3)("v-if",!0),(0,i.Q3)(" Restore Version Confirmation Dialog "),G.showRestoreDialog?((0,i.uX)(),(0,i.Wv)(se,{key:1,name:Z.t("Restore Version"),message:Z.t("A backup of the current version will be created before restoring. Do you want to continue?"),buttons:[{label:Z.t("Cancel"),callback:Z.cancelRestore},{label:Z.t("Restore"),type:"primary",callback:Z.restoreVersion}],onClose:Z.cancelRestore},null,8,["name","message","buttons","onClose"])):(0,i.Q3)("v-if",!0)],64)}],["__scopeId","data-v-401d4766"]])}}]);