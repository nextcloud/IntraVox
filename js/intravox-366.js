"use strict";(self.webpackChunknextcloud_intravox=self.webpackChunknextcloud_intravox||[]).push([[366],{366:(e,n,t)=>{t.r(n),t.d(n,{default:()=>H});var a=t(641),r=t(33);const o={class:"page-tree-content"},i={class:"page-tree-title"},d={key:0,class:"loading-state"},l={key:1,class:"error-state"},s={key:2,class:"empty-state"},c={key:3,class:"page-tree"},g={class:"tree-list"};var u=t(3334),p=t(5873),h=t(6802),v=t(3814);const m={class:"tree-item"},x=["aria-label"],b={key:1,class:"tree-toggle-spacer"},k={class:"tree-item-title"},f={key:0,class:"current-badge"},y={key:0,class:"tree-children"};var C=t(5602),N=t(7999),A=t(4333);const I={name:"PageTreeItem",components:{ChevronRight:C.A,ChevronDown:N.A,FileDocument:A.A},props:{item:{type:Object,required:!0},expandedNodes:{type:Set,required:!0}},emits:["toggle","navigate"],computed:{hasChildren(){return this.item.children&&this.item.children.length>0},isExpanded(){return this.expandedNodes.has(this.item.uniqueId)}},methods:{t:(e,n={})=>(0,u.Tl)("intravox",e,n)}};var T=t(5072),w=t.n(T),E=t(7825),P=t.n(E),X=t(7659),_=t.n(X),L=t(5056),q=t.n(L),z=t(540),D=t.n(z),F=t(1113),$=t.n(F),S=t(6472),Q={};Q.styleTagTransform=$(),Q.setAttributes=q(),Q.insert=_().bind(null,"head"),Q.domAPI=P(),Q.insertStyleElement=D(),w()(S.A,Q),S.A&&S.A.locals&&S.A.locals;var W=t(6262);const M=(0,W.A)(I,[["render",function(e,n,t,o,i,d){const l=(0,a.g2)("ChevronRight"),s=(0,a.g2)("ChevronDown"),c=(0,a.g2)("FileDocument"),g=(0,a.g2)("PageTreeItem",!0);return(0,a.uX)(),(0,a.CE)("li",m,[(0,a.Lk)("div",{class:(0,r.C4)(["tree-item-row",{"is-current":t.item.isCurrent}])},[(0,a.Q3)(" Expand/collapse toggle "),d.hasChildren?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"tree-toggle",onClick:n[0]||(n[0]=n=>e.$emit("toggle",t.item.uniqueId)),"aria-label":d.isExpanded?d.t("Collapse"):d.t("Expand")},[d.isExpanded?((0,a.uX)(),(0,a.Wv)(s,{key:1,size:18})):((0,a.uX)(),(0,a.Wv)(l,{key:0,size:18}))],8,x)):((0,a.uX)(),(0,a.CE)("span",b)),(0,a.Q3)(" Page icon and title "),(0,a.Lk)("button",{class:"tree-item-content",onClick:n[1]||(n[1]=n=>e.$emit("navigate",t.item.uniqueId))},[(0,a.bF)(c,{size:18,class:"tree-icon"}),(0,a.Lk)("span",k,(0,r.v_)(t.item.title),1),t.item.isCurrent?((0,a.uX)(),(0,a.CE)("span",f,(0,r.v_)(d.t("Current")),1)):(0,a.Q3)("v-if",!0)])],2),(0,a.Q3)(" Children "),d.hasChildren&&d.isExpanded?((0,a.uX)(),(0,a.CE)("ul",y,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.item.children,r=>((0,a.uX)(),(0,a.Wv)(g,{key:r.uniqueId,item:r,"expanded-nodes":t.expandedNodes,onToggle:n[2]||(n[2]=n=>e.$emit("toggle",n)),onNavigate:n[3]||(n[3]=n=>e.$emit("navigate",n))},null,8,["item","expanded-nodes"]))),128))])):(0,a.Q3)("v-if",!0)])}],["__scopeId","data-v-5306b040"]]),j={name:"PageTreeModal",components:{NcModal:p.FH,NcLoadingIcon:p.ne,PageTreeItem:M},props:{currentPageId:{type:String,default:null}},emits:["close","navigate"],data:()=>({tree:[],loading:!0,error:null,expandedNodes:new Set}),computed:{modalTitle(){return this.t("Page structure")}},async mounted(){await this.loadTree()},methods:{t:(e,n={})=>(0,u.Tl)("intravox",e,n),async loadTree(){this.loading=!0,this.error=null;try{const e=this.currentPageId?{currentPageId:this.currentPageId}:{},n=await h.Ay.get((0,v.Jv)("/apps/intravox/api/pages/tree"),{params:e});this.tree=n.data.tree||[],this.expandPathToCurrent(this.tree)}catch(e){console.error("PageTreeModal: Error loading tree:",e),this.error=this.t("Could not load page structure: {error}",{error:e.message})}finally{this.loading=!1}},expandPathToCurrent(e){for(const n of e){if(n.isCurrent)return this.expandAllDescendants(n),!0;if(n.children&&n.children.length>0&&this.expandPathToCurrent(n.children))return this.expandedNodes.add(n.uniqueId),!0}return!1},expandAllDescendants(e){if(e.children&&e.children.length>0){this.expandedNodes.add(e.uniqueId);for(const n of e.children)this.expandAllDescendants(n)}},toggleNode(e){this.expandedNodes.has(e)?this.expandedNodes.delete(e):this.expandedNodes.add(e),this.expandedNodes=new Set(this.expandedNodes)},handleNavigate(e){this.$emit("navigate",e),this.$emit("close")}}};var K=t(4031),R={};R.styleTagTransform=$(),R.setAttributes=q(),R.insert=_().bind(null,"head"),R.domAPI=P(),R.insertStyleElement=D(),w()(K.A,R),K.A&&K.A.locals&&K.A.locals;const H=(0,W.A)(j,[["render",function(e,n,t,u,p,h){const v=(0,a.g2)("NcLoadingIcon"),m=(0,a.g2)("PageTreeItem"),x=(0,a.g2)("NcModal");return(0,a.uX)(),(0,a.Wv)(x,{onClose:n[0]||(n[0]=n=>e.$emit("close")),name:h.modalTitle,size:"normal"},{default:(0,a.k6)(()=>[(0,a.Lk)("div",o,[(0,a.Lk)("h2",i,(0,r.v_)(h.modalTitle),1),p.loading?((0,a.uX)(),(0,a.CE)("div",d,[(0,a.bF)(v,{size:32}),(0,a.Lk)("p",null,(0,r.v_)(h.t("Loading page structure...")),1)])):p.error?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("p",null,(0,r.v_)(p.error),1)])):0===p.tree.length?((0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("p",null,(0,r.v_)(h.t("No pages found.")),1)])):((0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("ul",g,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(p.tree,e=>((0,a.uX)(),(0,a.Wv)(m,{key:e.uniqueId,item:e,"expanded-nodes":p.expandedNodes,onToggle:h.toggleNode,onNavigate:h.handleNavigate},null,8,["item","expanded-nodes","onToggle","onNavigate"]))),128))])]))])]),_:1},8,["name"])}],["__scopeId","data-v-19e16261"]])},4031:(e,n,t)=>{t.d(n,{A:()=>d});var a=t(1601),r=t.n(a),o=t(6314),i=t.n(o)()(r());i.push([e.id,"\n.page-tree-content[data-v-19e16261] {\n  padding: 20px;\n}\n.page-tree-title[data-v-19e16261] {\n  margin: 0 0 16px 0;\n  font-size: 20px;\n  font-weight: 600;\n  color: var(--color-main-text);\n}\n.loading-state[data-v-19e16261],\n.error-state[data-v-19e16261],\n.empty-state[data-v-19e16261] {\n  text-align: center;\n  padding: 40px;\n  color: var(--color-text-maxcontrast);\n}\n.error-state[data-v-19e16261] {\n  color: var(--color-error);\n}\n.page-tree[data-v-19e16261] {\n  max-height: 60vh;\n  overflow-y: auto;\n}\n.tree-list[data-v-19e16261] {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n",""]);const d=i},6472:(e,n,t)=>{t.d(n,{A:()=>d});var a=t(1601),r=t.n(a),o=t(6314),i=t.n(o)()(r());i.push([e.id,"\n.tree-item[data-v-5306b040] {\n  list-style: none;\n}\n.tree-item-row[data-v-5306b040] {\n  display: flex;\n  align-items: center;\n  padding: 4px 0;\n  border-radius: 4px;\n}\n.tree-item-row[data-v-5306b040]:hover {\n  background: var(--color-background-hover);\n}\n.tree-item-row.is-current[data-v-5306b040] {\n  background: var(--color-primary-element-light);\n}\n.tree-toggle[data-v-5306b040] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n  padding: 0;\n  margin: 0;\n  background: none;\n  border: none;\n  cursor: pointer;\n  color: var(--color-text-maxcontrast);\n  border-radius: 4px;\n  flex-shrink: 0;\n}\n.tree-toggle[data-v-5306b040]:hover {\n  background: var(--color-background-dark);\n  color: var(--color-main-text);\n}\n.tree-toggle-spacer[data-v-5306b040] {\n  width: 24px;\n  flex-shrink: 0;\n}\n.tree-item-content[data-v-5306b040] {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  padding: 4px 8px;\n  background: none;\n  border: none;\n  cursor: pointer;\n  text-align: left;\n  color: var(--color-main-text);\n  border-radius: 4px;\n  min-width: 0;\n}\n.tree-item-content[data-v-5306b040]:hover {\n  background: var(--color-background-dark);\n}\n.tree-icon[data-v-5306b040] {\n  color: var(--color-text-maxcontrast);\n  flex-shrink: 0;\n}\n.tree-item-title[data-v-5306b040] {\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.current-badge[data-v-5306b040] {\n  flex-shrink: 0;\n  font-size: 11px;\n  padding: 2px 6px;\n  background: var(--color-primary-element);\n  color: var(--color-primary-element-text);\n  border-radius: 10px;\n  font-weight: 500;\n}\n.tree-children[data-v-5306b040] {\n  list-style: none;\n  margin: 0;\n  padding: 0 0 0 24px;\n}\n",""]);const d=i}}]);