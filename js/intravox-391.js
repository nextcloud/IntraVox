"use strict";(self.webpackChunknextcloud_intravox=self.webpackChunknextcloud_intravox||[]).push([[391],{441:(e,n,t)=>{t(4138)},979:(e,n,t)=>{t.d(n,{X:()=>r.X});var r=t(4952)},1578:(e,n,t)=>{t.d(n,{A:()=>o});var r=t(979),a=t(5588);t(2084);const o=(0,t(6262).A)(a.A,[["render",r.X],["__scopeId","data-v-31a63743"]])},2084:(e,n,t)=>{t(7831)},2153:(e,n,t)=>{t.d(n,{A:()=>r.A});var r=t(4218)},2367:(e,n,t)=>{t.d(n,{A:()=>l});var r=t(717),a=t(301),o=t(2693),s=t(9946),d=t(708);const l={name:"PageTreeSelectItem",components:{ChevronRight:r.A,ChevronDown:a.A,FileDocument:o.A,FolderOutline:s.A,Check:d.A},props:{item:{type:Object,required:!0},expandedNodes:{type:Set,required:!0},selectedId:{type:String,default:null},focusedId:{type:String,default:null},searchQuery:{type:String,default:""}},emits:["toggle","select","focus"],computed:{hasChildren(){return this.item.children&&this.item.children.length>0},isExpanded(){return this.expandedNodes.has(this.item.uniqueId)},isSelected(){return this.item.uniqueId===this.selectedId},isFocused(){return this.item.uniqueId===this.focusedId}}}},3048:(e,n,t)=>{t.d(n,{A:()=>d});var r=t(1601),a=t.n(r),o=t(6314),s=t.n(o)()(a());s.push([e.id,"\n.tree-select-item[data-v-31a63743] {\n  list-style: none;\n}\n.item-row[data-v-31a63743] {\n  display: flex;\n  align-items: center;\n  border-radius: 4px;\n  margin: 1px 0;\n}\n.item-row[data-v-31a63743]:hover {\n  background: var(--color-background-hover);\n}\n.item-row.is-focused[data-v-31a63743] {\n  background: var(--color-background-hover);\n  outline: 2px solid var(--color-primary-element);\n  outline-offset: -2px;\n}\n.item-row.is-selected[data-v-31a63743] {\n  background: var(--color-primary-element-light);\n}\n.item-row.matches-search .item-title[data-v-31a63743] {\n  font-weight: 600;\n}\n.expand-toggle[data-v-31a63743] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 22px;\n  height: 22px;\n  padding: 0;\n  margin: 0;\n  background: none;\n  border: none;\n  cursor: pointer;\n  color: var(--color-text-maxcontrast);\n  border-radius: 4px;\n  flex-shrink: 0;\n}\n.expand-toggle[data-v-31a63743]:hover {\n  background: var(--color-background-dark);\n  color: var(--color-main-text);\n}\n.toggle-spacer[data-v-31a63743] {\n  width: 22px;\n  flex-shrink: 0;\n}\n.item-content[data-v-31a63743] {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  flex: 1;\n  padding: 5px 8px 5px 4px;\n  background: none;\n  border: none;\n  cursor: pointer;\n  text-align: left;\n  color: var(--color-main-text);\n  font-size: 13px;\n  min-width: 0;\n}\n.item-icon[data-v-31a63743] {\n  flex-shrink: 0;\n  color: var(--color-text-maxcontrast);\n}\n.item-icon.folder-icon[data-v-31a63743] {\n  color: var(--color-primary-element);\n}\n.item-title[data-v-31a63743] {\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.check-icon[data-v-31a63743] {\n  flex-shrink: 0;\n  color: var(--color-primary-element);\n}\n.children-list[data-v-31a63743] {\n  list-style: none;\n  margin: 0;\n  padding: 0 0 0 22px;\n}\n",""]);const d=s},4113:(e,n,t)=>{t.d(n,{X:()=>b});var r=t(641),a=t(3751),o=t(33);const s={class:"page-tree-select",ref:"selectContainer"},d=["disabled"],l={key:0,class:"selected-value"},i={key:0,class:"selected-path"},c={class:"selected-title"},u={key:1,class:"placeholder"},h={key:0,class:"select-dropdown",ref:"dropdown"},p={class:"search-wrapper"},g=["placeholder"],f={class:"tree-wrapper",ref:"treeWrapper"},v={key:0,class:"loading-state"},m={key:1,class:"empty-state"},x={key:2,class:"tree-list"};function b(e,n,t,b,y,k){const w=(0,r.g2)("FileDocument"),I=(0,r.g2)("ChevronDown"),C=(0,r.g2)("Magnify"),A=(0,r.g2)("Close"),T=(0,r.g2)("NcLoadingIcon"),P=(0,r.g2)("PageTreeSelectItem");return(0,r.uX)(),(0,r.CE)("div",s,[(0,r.Q3)(" Selected value / trigger "),(0,r.Lk)("button",{type:"button",class:(0,o.C4)(["select-trigger",{"is-open":y.isOpen,"has-value":k.selectedPage,"is-disabled":t.disabled}]),disabled:t.disabled,onClick:n[0]||(n[0]=(...e)=>k.toggleDropdown&&k.toggleDropdown(...e)),ref:"trigger"},[k.selectedPage?((0,r.uX)(),(0,r.CE)("span",l,[(0,r.bF)(w,{size:16,class:"selected-icon"}),k.selectedPath?((0,r.uX)(),(0,r.CE)("span",i,(0,o.v_)(k.selectedPath)+" /",1)):(0,r.Q3)("v-if",!0),(0,r.Lk)("span",c,(0,o.v_)(k.selectedPage.title),1)])):((0,r.uX)(),(0,r.CE)("span",u,(0,o.v_)(t.placeholder),1)),(0,r.bF)(I,{size:18,class:(0,o.C4)(["trigger-icon",{rotated:y.isOpen}])},null,8,["class"])],10,d),(0,r.Q3)(" Dropdown "),y.isOpen?((0,r.uX)(),(0,r.CE)("div",h,[(0,r.Q3)(" Search input "),(0,r.Lk)("div",p,[(0,r.bF)(C,{size:16,class:"search-icon"}),(0,r.bo)((0,r.Lk)("input",{ref:"searchInput","onUpdate:modelValue":n[1]||(n[1]=e=>y.searchQuery=e),type:"text",class:"search-input",placeholder:k.t("Search pages..."),onKeydown:[n[2]||(n[2]=(0,a.jR)((...e)=>k.closeDropdown&&k.closeDropdown(...e),["escape"])),n[3]||(n[3]=(0,a.jR)((0,a.D$)((...e)=>k.focusNext&&k.focusNext(...e),["prevent"]),["down"])),n[4]||(n[4]=(0,a.jR)((0,a.D$)((...e)=>k.focusPrev&&k.focusPrev(...e),["prevent"]),["up"])),n[5]||(n[5]=(0,a.jR)((0,a.D$)((...e)=>k.selectFocused&&k.selectFocused(...e),["prevent"]),["enter"]))]},null,40,g),[[a.Jo,y.searchQuery]]),y.searchQuery?((0,r.uX)(),(0,r.CE)("button",{key:0,class:"clear-search",onClick:n[6]||(n[6]=e=>y.searchQuery="")},[(0,r.bF)(A,{size:14})])):(0,r.Q3)("v-if",!0)]),(0,r.Q3)(" Tree list "),(0,r.Lk)("div",f,[y.loading?((0,r.uX)(),(0,r.CE)("div",v,[(0,r.bF)(T,{size:24})])):0===k.filteredTree.length?((0,r.uX)(),(0,r.CE)("div",m,(0,o.v_)(y.searchQuery?k.t("No pages found"):k.t("No pages available")),1)):((0,r.uX)(),(0,r.CE)("ul",x,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(k.filteredTree,e=>((0,r.uX)(),(0,r.Wv)(P,{key:e.uniqueId,item:e,"expanded-nodes":y.expandedNodes,"selected-id":t.modelValue,"focused-id":y.focusedId,"search-query":y.searchQuery,onToggle:k.toggleNode,onSelect:k.selectPage,onFocus:n[7]||(n[7]=e=>y.focusedId=e)},null,8,["item","expanded-nodes","selected-id","focused-id","search-query","onToggle","onSelect"]))),128))]))],512),(0,r.Q3)(" Clear selection "),k.selectedPage&&t.clearable?((0,r.uX)(),(0,r.CE)("button",{key:0,class:"clear-selection",onClick:n[8]||(n[8]=(...e)=>k.clearSelection&&k.clearSelection(...e))},[(0,r.bF)(A,{size:16}),(0,r.eW)(" "+(0,o.v_)(k.t("Clear selection")),1)])):(0,r.Q3)("v-if",!0)],512)):(0,r.Q3)("v-if",!0)],512)}},4138:(e,n,t)=>{var r=t(5072),a=t.n(r),o=t(7825),s=t.n(o),d=t(7659),l=t.n(d),i=t(5056),c=t.n(i),u=t(540),h=t.n(u),p=t(1113),g=t.n(p),f=t(4645),v={};v.styleTagTransform=g(),v.setAttributes=c(),v.insert=l().bind(null,"head"),v.domAPI=s(),v.insertStyleElement=h(),a()(f.A,v),f.A&&f.A.locals&&f.A.locals},4218:(e,n,t)=>{t.d(n,{A:()=>h});var r=t(3334),a=t(5873),o=t(6802),s=t(3814),d=t(301),l=t(2693),i=t(5101),c=t(7448),u=t(1578);const h={name:"PageTreeSelect",components:{NcLoadingIcon:a.ne,ChevronDown:d.A,FileDocument:l.A,Magnify:i.A,Close:c.A,PageTreeSelectItem:u.A},props:{modelValue:{type:String,default:null},placeholder:{type:String,default:"Select a page"},clearable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},language:{type:String,default:null}},emits:["update:modelValue","select"],data:()=>({isOpen:!1,loading:!1,tree:[],expandedNodes:new Set,searchQuery:"",focusedId:null,flatPages:[]}),computed:{selectedPage(){return this.modelValue?this.flatPages.find(e=>e.uniqueId===this.modelValue):null},selectedPath(){return this.selectedPage&&this.selectedPage.path?this.selectedPage.path:null},filteredTree(){if(!this.searchQuery.trim())return this.tree;const e=this.searchQuery.toLowerCase();return this.filterTree(this.tree,e)},focusableItems(){return this.getFlatVisibleItems(this.filteredTree)}},watch:{isOpen(e){e?this.$nextTick(()=>{this.$refs.searchInput?.focus(),this.modelValue&&this.expandPathToItem(this.tree,this.modelValue)}):(this.searchQuery="",this.focusedId=null)},language(){this.loadTree()}},mounted(){document.addEventListener("click",this.handleClickOutside),this.loadTree()},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)},methods:{t:(e,n={})=>(0,r.Tl)("intravox",e,n),async loadTree(){this.loading=!0;try{const e={};this.language&&(e.language=this.language);const n=(await o.Ay.get((0,s.Jv)("/apps/intravox/api/pages/tree"),{params:e})).data.tree||[];this.tree=n,this.flatPages=this.flattenTree(this.tree,""),this.tree.forEach(e=>{e.children&&e.children.length>0&&this.expandedNodes.add(e.uniqueId)})}catch(e){console.error("PageTreeSelect: Error loading tree:",e)}finally{this.loading=!1}},flattenTree(e,n){const t=[];for(const r of e){const e=n;if(t.push({uniqueId:r.uniqueId,title:r.title,path:e,hasChildren:r.children&&r.children.length>0}),r.children&&r.children.length>0){const e=n?`${n} / ${r.title}`:r.title;t.push(...this.flattenTree(r.children,e))}}return t},filterTree(e,n){const t=[];for(const r of e){const e=r.title.toLowerCase().includes(n),a=r.children?this.filterTree(r.children,n):[];(e||a.length>0)&&(t.push({...r,children:a,matchesSearch:e}),a.length>0&&this.expandedNodes.add(r.uniqueId))}return t},getFlatVisibleItems(e){const n=[];for(const t of e)n.push(t),t.children&&t.children.length>0&&this.expandedNodes.has(t.uniqueId)&&n.push(...this.getFlatVisibleItems(t.children));return n},expandPathToItem(e,n){for(const t of e){if(t.uniqueId===n)return!0;if(t.children&&t.children.length>0&&this.expandPathToItem(t.children,n))return this.expandedNodes.add(t.uniqueId),!0}return!1},toggleDropdown(){this.isOpen=!this.isOpen},closeDropdown(){this.isOpen=!1},toggleNode(e){this.expandedNodes.has(e)?this.expandedNodes.delete(e):this.expandedNodes.add(e),this.expandedNodes=new Set(this.expandedNodes)},selectPage(e){this.$emit("update:modelValue",e.uniqueId),this.$emit("select",e),this.closeDropdown()},clearSelection(){this.$emit("update:modelValue",null),this.$emit("select",null),this.closeDropdown()},handleClickOutside(e){this.$refs.selectContainer&&!this.$refs.selectContainer.contains(e.target)&&this.closeDropdown()},focusNext(){const e=this.focusableItems;if(0===e.length)return;const n=e.findIndex(e=>e.uniqueId===this.focusedId),t=n<e.length-1?n+1:0;this.focusedId=e[t].uniqueId,this.scrollToFocused()},focusPrev(){const e=this.focusableItems;if(0===e.length)return;const n=e.findIndex(e=>e.uniqueId===this.focusedId),t=n>0?n-1:e.length-1;this.focusedId=e[t].uniqueId,this.scrollToFocused()},selectFocused(){if(this.focusedId){const e=this.flatPages.find(e=>e.uniqueId===this.focusedId);e&&this.selectPage(e)}},scrollToFocused(){this.$nextTick(()=>{const e=this.$refs.treeWrapper?.querySelector(".is-focused");e&&e.scrollIntoView({block:"nearest"})})}}}},4645:(e,n,t)=>{t.d(n,{A:()=>d});var r=t(1601),a=t.n(r),o=t(6314),s=t.n(o)()(a());s.push([e.id,"\n.page-tree-select[data-v-0d105bf8] {\n  position: relative;\n  width: 100%;\n}\n.select-trigger[data-v-0d105bf8] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  padding: 6px 10px;\n  background: var(--color-main-background);\n  border: 1px solid var(--color-border);\n  border-radius: var(--border-radius);\n  cursor: pointer;\n  text-align: left;\n  font-size: 13px;\n  min-height: 34px;\n  gap: 8px;\n}\n.select-trigger[data-v-0d105bf8]:hover:not(:disabled) {\n  border-color: var(--color-primary-element);\n}\n.select-trigger.is-disabled[data-v-0d105bf8] {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background: var(--color-background-dark);\n}\n.select-trigger.is-open[data-v-0d105bf8] {\n  border-color: var(--color-primary-element);\n  border-bottom-left-radius: 0;\n  border-bottom-right-radius: 0;\n}\n.selected-value[data-v-0d105bf8] {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  flex: 1;\n  min-width: 0;\n  overflow: hidden;\n}\n.selected-icon[data-v-0d105bf8] {\n  flex-shrink: 0;\n  color: var(--color-primary-element);\n}\n.selected-path[data-v-0d105bf8] {\n  color: var(--color-text-maxcontrast);\n  font-size: 12px;\n  white-space: nowrap;\n}\n.selected-title[data-v-0d105bf8] {\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.placeholder[data-v-0d105bf8] {\n  color: var(--color-text-maxcontrast);\n}\n.trigger-icon[data-v-0d105bf8] {\n  flex-shrink: 0;\n  color: var(--color-text-maxcontrast);\n  transition: transform 0.2s;\n}\n.trigger-icon.rotated[data-v-0d105bf8] {\n  transform: rotate(180deg);\n}\n.select-dropdown[data-v-0d105bf8] {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  background: var(--color-main-background);\n  border: 1px solid var(--color-primary-element);\n  border-top: none;\n  border-radius: 0 0 var(--border-radius) var(--border-radius);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  z-index: 1000;\n  max-height: 350px;\n  display: flex;\n  flex-direction: column;\n}\n.search-wrapper[data-v-0d105bf8] {\n  display: flex;\n  align-items: center;\n  padding: 8px;\n  border-bottom: 1px solid var(--color-border);\n  gap: 8px;\n}\n.search-icon[data-v-0d105bf8] {\n  flex-shrink: 0;\n  color: var(--color-text-maxcontrast);\n}\n.search-input[data-v-0d105bf8] {\n  flex: 1;\n  border: none;\n  background: none;\n  font-size: 13px;\n  outline: none;\n  padding: 4px 0;\n}\n.search-input[data-v-0d105bf8]::placeholder {\n  color: var(--color-text-maxcontrast);\n}\n.clear-search[data-v-0d105bf8] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  height: 20px;\n  padding: 0;\n  border: none;\n  background: var(--color-background-dark);\n  border-radius: 50%;\n  cursor: pointer;\n  color: var(--color-text-maxcontrast);\n}\n.clear-search[data-v-0d105bf8]:hover {\n  background: var(--color-error);\n  color: white;\n}\n.tree-wrapper[data-v-0d105bf8] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n  max-height: 250px;\n}\n.loading-state[data-v-0d105bf8],\n.empty-state[data-v-0d105bf8] {\n  padding: 20px;\n  text-align: center;\n  color: var(--color-text-maxcontrast);\n}\n.tree-list[data-v-0d105bf8] {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n.clear-selection[data-v-0d105bf8] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  padding: 8px;\n  border: none;\n  border-top: 1px solid var(--color-border);\n  background: var(--color-background-dark);\n  cursor: pointer;\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n}\n.clear-selection[data-v-0d105bf8]:hover {\n  background: var(--color-error-hover);\n  color: var(--color-error);\n}\n",""]);const d=s},4952:(e,n,t)=>{t.d(n,{X:()=>u});var r=t(641),a=t(3751),o=t(33);const s={class:"tree-select-item"},d=["aria-label"],l={key:1,class:"toggle-spacer"},i={class:"item-title"},c={key:0,class:"children-list"};function u(e,n,t,u,h,p){const g=(0,r.g2)("ChevronRight"),f=(0,r.g2)("ChevronDown"),v=(0,r.g2)("FolderOutline"),m=(0,r.g2)("FileDocument"),x=(0,r.g2)("Check"),b=(0,r.g2)("PageTreeSelectItem",!0);return(0,r.uX)(),(0,r.CE)("li",s,[(0,r.Lk)("div",{class:(0,o.C4)(["item-row",{"is-selected":p.isSelected,"is-focused":p.isFocused,"matches-search":t.item.matchesSearch}]),onMouseenter:n[2]||(n[2]=n=>e.$emit("focus",t.item.uniqueId))},[(0,r.Q3)(" Expand/collapse toggle "),p.hasChildren?((0,r.uX)(),(0,r.CE)("button",{key:0,class:"expand-toggle",onClick:n[0]||(n[0]=(0,a.D$)(n=>e.$emit("toggle",t.item.uniqueId),["stop"])),"aria-label":p.isExpanded?"Collapse":"Expand"},[p.isExpanded?((0,r.uX)(),(0,r.Wv)(f,{key:1,size:16})):((0,r.uX)(),(0,r.Wv)(g,{key:0,size:16}))],8,d)):((0,r.uX)(),(0,r.CE)("span",l)),(0,r.Q3)(" Page item "),(0,r.Lk)("button",{class:"item-content",onClick:n[1]||(n[1]=n=>e.$emit("select",t.item))},[p.hasChildren?((0,r.uX)(),(0,r.Wv)(v,{key:0,size:16,class:"item-icon folder-icon"})):((0,r.uX)(),(0,r.Wv)(m,{key:1,size:16,class:"item-icon"})),(0,r.Lk)("span",i,(0,o.v_)(t.item.title),1),p.isSelected?((0,r.uX)(),(0,r.Wv)(x,{key:2,size:16,class:"check-icon"})):(0,r.Q3)("v-if",!0)])],34),(0,r.Q3)(" Children "),p.hasChildren&&p.isExpanded?((0,r.uX)(),(0,r.CE)("ul",c,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t.item.children,a=>((0,r.uX)(),(0,r.Wv)(b,{key:a.uniqueId,item:a,"expanded-nodes":t.expandedNodes,"selected-id":t.selectedId,"focused-id":t.focusedId,"search-query":t.searchQuery,onToggle:n[3]||(n[3]=n=>e.$emit("toggle",n)),onSelect:n[4]||(n[4]=n=>e.$emit("select",n)),onFocus:n[5]||(n[5]=n=>e.$emit("focus",n))},null,8,["item","expanded-nodes","selected-id","focused-id","search-query"]))),128))])):(0,r.Q3)("v-if",!0)])}},5588:(e,n,t)=>{t.d(n,{A:()=>r.A});var r=t(2367)},5734:(e,n,t)=>{t.d(n,{X:()=>r.X});var r=t(4113)},6391:(e,n,t)=>{t.d(n,{A:()=>o});var r=t(5734),a=t(2153);t(441);const o=(0,t(6262).A)(a.A,[["render",r.X],["__scopeId","data-v-0d105bf8"]])},7831:(e,n,t)=>{var r=t(5072),a=t.n(r),o=t(7825),s=t.n(o),d=t(7659),l=t.n(d),i=t(5056),c=t.n(i),u=t(540),h=t.n(u),p=t(1113),g=t.n(p),f=t(3048),v={};v.styleTagTransform=g(),v.setAttributes=c(),v.insert=l().bind(null,"head"),v.domAPI=s(),v.insertStyleElement=h(),a()(f.A,v),f.A&&f.A.locals&&f.A.locals}}]);