"use strict";(self.webpackChunknextcloud_intravox=self.webpackChunknextcloud_intravox||[]).push([[801],{1493:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a)()(o());s.push([e.id,"\n.page-tree-select[data-v-312268b0] {\n  position: relative;\n  width: 100%;\n}\n.select-trigger[data-v-312268b0] {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  padding: 6px 10px;\n  background: var(--color-main-background);\n  border: 1px solid var(--color-border);\n  border-radius: var(--border-radius);\n  cursor: pointer;\n  text-align: left;\n  font-size: 13px;\n  min-height: 34px;\n  gap: 8px;\n}\n.select-trigger[data-v-312268b0]:hover:not(:disabled) {\n  border-color: var(--color-primary-element);\n}\n.select-trigger.is-disabled[data-v-312268b0] {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background: var(--color-background-dark);\n}\n.select-trigger.is-open[data-v-312268b0] {\n  border-color: var(--color-primary-element);\n  border-bottom-left-radius: 0;\n  border-bottom-right-radius: 0;\n}\n.selected-value[data-v-312268b0] {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  flex: 1;\n  min-width: 0;\n  overflow: hidden;\n}\n.selected-icon[data-v-312268b0] {\n  flex-shrink: 0;\n  color: var(--color-primary-element);\n}\n.selected-path[data-v-312268b0] {\n  color: var(--color-text-maxcontrast);\n  font-size: 12px;\n  white-space: nowrap;\n}\n.selected-title[data-v-312268b0] {\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.placeholder[data-v-312268b0] {\n  color: var(--color-text-maxcontrast);\n}\n.trigger-icon[data-v-312268b0] {\n  flex-shrink: 0;\n  color: var(--color-text-maxcontrast);\n  transition: transform 0.2s;\n}\n.trigger-icon.rotated[data-v-312268b0] {\n  transform: rotate(180deg);\n}\n.select-dropdown[data-v-312268b0] {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  background: var(--color-main-background);\n  border: 1px solid var(--color-primary-element);\n  border-top: none;\n  border-radius: 0 0 var(--border-radius) var(--border-radius);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  z-index: 1000;\n  max-height: 350px;\n  display: flex;\n  flex-direction: column;\n}\n.search-wrapper[data-v-312268b0] {\n  display: flex;\n  align-items: center;\n  padding: 8px;\n  border-bottom: 1px solid var(--color-border);\n  gap: 8px;\n}\n.search-icon[data-v-312268b0] {\n  flex-shrink: 0;\n  color: var(--color-text-maxcontrast);\n}\n.search-input[data-v-312268b0] {\n  flex: 1;\n  border: none;\n  background: none;\n  font-size: 13px;\n  outline: none;\n  padding: 4px 0;\n}\n.search-input[data-v-312268b0]::placeholder {\n  color: var(--color-text-maxcontrast);\n}\n.clear-search[data-v-312268b0] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  height: 20px;\n  padding: 0;\n  border: none;\n  background: var(--color-background-dark);\n  border-radius: 50%;\n  cursor: pointer;\n  color: var(--color-text-maxcontrast);\n}\n.clear-search[data-v-312268b0]:hover {\n  background: var(--color-error);\n  color: white;\n}\n.tree-wrapper[data-v-312268b0] {\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n  max-height: 250px;\n}\n.loading-state[data-v-312268b0],\n.empty-state[data-v-312268b0] {\n  padding: 20px;\n  text-align: center;\n  color: var(--color-text-maxcontrast);\n}\n.tree-list[data-v-312268b0] {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n.clear-selection[data-v-312268b0] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  padding: 8px;\n  border: none;\n  border-top: 1px solid var(--color-border);\n  background: var(--color-background-dark);\n  cursor: pointer;\n  font-size: 12px;\n  color: var(--color-text-maxcontrast);\n}\n.clear-selection[data-v-312268b0]:hover {\n  background: var(--color-error-hover);\n  color: var(--color-error);\n}\n",""]);const i=s},3048:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a)()(o());s.push([e.id,"\n.tree-select-item[data-v-31a63743] {\n  list-style: none;\n}\n.item-row[data-v-31a63743] {\n  display: flex;\n  align-items: center;\n  border-radius: 4px;\n  margin: 1px 0;\n}\n.item-row[data-v-31a63743]:hover {\n  background: var(--color-background-hover);\n}\n.item-row.is-focused[data-v-31a63743] {\n  background: var(--color-background-hover);\n  outline: 2px solid var(--color-primary-element);\n  outline-offset: -2px;\n}\n.item-row.is-selected[data-v-31a63743] {\n  background: var(--color-primary-element-light);\n}\n.item-row.matches-search .item-title[data-v-31a63743] {\n  font-weight: 600;\n}\n.expand-toggle[data-v-31a63743] {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 22px;\n  height: 22px;\n  padding: 0;\n  margin: 0;\n  background: none;\n  border: none;\n  cursor: pointer;\n  color: var(--color-text-maxcontrast);\n  border-radius: 4px;\n  flex-shrink: 0;\n}\n.expand-toggle[data-v-31a63743]:hover {\n  background: var(--color-background-dark);\n  color: var(--color-main-text);\n}\n.toggle-spacer[data-v-31a63743] {\n  width: 22px;\n  flex-shrink: 0;\n}\n.item-content[data-v-31a63743] {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  flex: 1;\n  padding: 5px 8px 5px 4px;\n  background: none;\n  border: none;\n  cursor: pointer;\n  text-align: left;\n  color: var(--color-main-text);\n  font-size: 13px;\n  min-width: 0;\n}\n.item-icon[data-v-31a63743] {\n  flex-shrink: 0;\n  color: var(--color-text-maxcontrast);\n}\n.item-icon.folder-icon[data-v-31a63743] {\n  color: var(--color-primary-element);\n}\n.item-title[data-v-31a63743] {\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.check-icon[data-v-31a63743] {\n  flex-shrink: 0;\n  color: var(--color-primary-element);\n}\n.children-list[data-v-31a63743] {\n  list-style: none;\n  margin: 0;\n  padding: 0 0 0 22px;\n}\n",""]);const i=s},7801:(e,n,t)=>{t.d(n,{A:()=>ne});var r=t(641),o=t(33),a=t(3751);const s={class:"page-tree-select",ref:"selectContainer"},i=["disabled"],l={key:0,class:"selected-value"},d={key:0,class:"selected-path"},c={class:"selected-title"},u={key:1,class:"placeholder"},h={key:0,class:"select-dropdown",ref:"dropdown"},p={class:"search-wrapper"},g=["placeholder"],v={class:"tree-wrapper",ref:"treeWrapper"},m={key:0,class:"loading-state"},f={key:1,class:"empty-state"},x={key:2,class:"tree-list"};var b=t(3334),y=t(5873),k=t(6802),w=t(3814),I=t(7999),C=t(4333),T=t(2896),P=t(5754);const S={class:"tree-select-item"},q=["aria-label"],E={key:1,class:"toggle-spacer"},A={class:"item-title"},F={key:0,class:"children-list"};var Q=t(5602),N=t(1187),X=t(6895);const D={name:"PageTreeSelectItem",components:{ChevronRight:Q.A,ChevronDown:I.A,FileDocument:C.A,FolderOutline:N.A,Check:X.A},props:{item:{type:Object,required:!0},expandedNodes:{type:Set,required:!0},selectedId:{type:String,default:null},focusedId:{type:String,default:null},searchQuery:{type:String,default:""}},emits:["toggle","select","focus"],computed:{hasChildren(){return this.item.children&&this.item.children.length>0},isExpanded(){return this.expandedNodes.has(this.item.uniqueId)},isSelected(){return this.item.uniqueId===this.selectedId},isFocused(){return this.item.uniqueId===this.focusedId}}};var $=t(5072),z=t.n($),L=t(7825),O=t.n(L),V=t(7659),_=t.n(V),W=t(5056),j=t.n(W),R=t(540),K=t.n(R),M=t(1113),B=t.n(M),J=t(3048),U={};U.styleTagTransform=B(),U.setAttributes=j(),U.insert=_().bind(null,"head"),U.domAPI=O(),U.insertStyleElement=K(),z()(J.A,U),J.A&&J.A.locals&&J.A.locals;var G=t(6262);const H=(0,G.A)(D,[["render",function(e,n,t,s,i,l){const d=(0,r.g2)("ChevronRight"),c=(0,r.g2)("ChevronDown"),u=(0,r.g2)("FolderOutline"),h=(0,r.g2)("FileDocument"),p=(0,r.g2)("Check"),g=(0,r.g2)("PageTreeSelectItem",!0);return(0,r.uX)(),(0,r.CE)("li",S,[(0,r.Lk)("div",{class:(0,o.C4)(["item-row",{"is-selected":l.isSelected,"is-focused":l.isFocused,"matches-search":t.item.matchesSearch}]),onMouseenter:n[2]||(n[2]=n=>e.$emit("focus",t.item.uniqueId))},[(0,r.Q3)(" Expand/collapse toggle "),l.hasChildren?((0,r.uX)(),(0,r.CE)("button",{key:0,class:"expand-toggle",onClick:n[0]||(n[0]=(0,a.D$)(n=>e.$emit("toggle",t.item.uniqueId),["stop"])),"aria-label":l.isExpanded?"Collapse":"Expand"},[l.isExpanded?((0,r.uX)(),(0,r.Wv)(c,{key:1,size:16})):((0,r.uX)(),(0,r.Wv)(d,{key:0,size:16}))],8,q)):((0,r.uX)(),(0,r.CE)("span",E)),(0,r.Q3)(" Page item "),(0,r.Lk)("button",{class:"item-content",onClick:n[1]||(n[1]=n=>e.$emit("select",t.item))},[l.hasChildren?((0,r.uX)(),(0,r.Wv)(u,{key:0,size:16,class:"item-icon folder-icon"})):((0,r.uX)(),(0,r.Wv)(h,{key:1,size:16,class:"item-icon"})),(0,r.Lk)("span",A,(0,o.v_)(t.item.title),1),l.isSelected?((0,r.uX)(),(0,r.Wv)(p,{key:2,size:16,class:"check-icon"})):(0,r.Q3)("v-if",!0)])],34),(0,r.Q3)(" Children "),l.hasChildren&&l.isExpanded?((0,r.uX)(),(0,r.CE)("ul",F,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t.item.children,o=>((0,r.uX)(),(0,r.Wv)(g,{key:o.uniqueId,item:o,"expanded-nodes":t.expandedNodes,"selected-id":t.selectedId,"focused-id":t.focusedId,"search-query":t.searchQuery,onToggle:n[3]||(n[3]=n=>e.$emit("toggle",n)),onSelect:n[4]||(n[4]=n=>e.$emit("select",n)),onFocus:n[5]||(n[5]=n=>e.$emit("focus",n))},null,8,["item","expanded-nodes","selected-id","focused-id","search-query"]))),128))])):(0,r.Q3)("v-if",!0)])}],["__scopeId","data-v-31a63743"]]),Y={name:"PageTreeSelect",components:{NcLoadingIcon:y.ne,ChevronDown:I.A,FileDocument:C.A,Magnify:T.A,Close:P.A,PageTreeSelectItem:H},props:{modelValue:{type:String,default:null},placeholder:{type:String,default:"Select a page"},clearable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],data:()=>({isOpen:!1,loading:!1,tree:[],expandedNodes:new Set,searchQuery:"",focusedId:null,flatPages:[]}),computed:{selectedPage(){return this.modelValue?this.flatPages.find(e=>e.uniqueId===this.modelValue):null},selectedPath(){return this.selectedPage&&this.selectedPage.path?this.selectedPage.path:null},filteredTree(){if(!this.searchQuery.trim())return this.tree;const e=this.searchQuery.toLowerCase();return this.filterTree(this.tree,e)},focusableItems(){return this.getFlatVisibleItems(this.filteredTree)}},watch:{isOpen(e){e?this.$nextTick(()=>{this.$refs.searchInput?.focus(),this.modelValue&&this.expandPathToItem(this.tree,this.modelValue)}):(this.searchQuery="",this.focusedId=null)}},mounted(){document.addEventListener("click",this.handleClickOutside),this.loadTree()},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)},methods:{t:(e,n={})=>(0,b.Tl)("intravox",e,n),async loadTree(){this.loading=!0;try{const e=await k.Ay.get((0,w.Jv)("/apps/intravox/api/pages/tree"));this.tree=e.data.tree||[],this.flatPages=this.flattenTree(this.tree,""),this.tree.forEach(e=>{e.children&&e.children.length>0&&this.expandedNodes.add(e.uniqueId)})}catch(e){console.error("PageTreeSelect: Error loading tree:",e)}finally{this.loading=!1}},flattenTree(e,n){const t=[];for(const r of e){const e=n;if(t.push({uniqueId:r.uniqueId,title:r.title,path:e,hasChildren:r.children&&r.children.length>0}),r.children&&r.children.length>0){const e=n?`${n} / ${r.title}`:r.title;t.push(...this.flattenTree(r.children,e))}}return t},filterTree(e,n){const t=[];for(const r of e){const e=r.title.toLowerCase().includes(n),o=r.children?this.filterTree(r.children,n):[];(e||o.length>0)&&(t.push({...r,children:o,matchesSearch:e}),o.length>0&&this.expandedNodes.add(r.uniqueId))}return t},getFlatVisibleItems(e){const n=[];for(const t of e)n.push(t),t.children&&t.children.length>0&&this.expandedNodes.has(t.uniqueId)&&n.push(...this.getFlatVisibleItems(t.children));return n},expandPathToItem(e,n){for(const t of e){if(t.uniqueId===n)return!0;if(t.children&&t.children.length>0&&this.expandPathToItem(t.children,n))return this.expandedNodes.add(t.uniqueId),!0}return!1},toggleDropdown(){this.isOpen=!this.isOpen},closeDropdown(){this.isOpen=!1},toggleNode(e){this.expandedNodes.has(e)?this.expandedNodes.delete(e):this.expandedNodes.add(e),this.expandedNodes=new Set(this.expandedNodes)},selectPage(e){this.$emit("update:modelValue",e.uniqueId),this.$emit("select",e),this.closeDropdown()},clearSelection(){this.$emit("update:modelValue",null),this.$emit("select",null),this.closeDropdown()},handleClickOutside(e){this.$refs.selectContainer&&!this.$refs.selectContainer.contains(e.target)&&this.closeDropdown()},focusNext(){const e=this.focusableItems;if(0===e.length)return;const n=e.findIndex(e=>e.uniqueId===this.focusedId),t=n<e.length-1?n+1:0;this.focusedId=e[t].uniqueId,this.scrollToFocused()},focusPrev(){const e=this.focusableItems;if(0===e.length)return;const n=e.findIndex(e=>e.uniqueId===this.focusedId),t=n>0?n-1:e.length-1;this.focusedId=e[t].uniqueId,this.scrollToFocused()},selectFocused(){if(this.focusedId){const e=this.flatPages.find(e=>e.uniqueId===this.focusedId);e&&this.selectPage(e)}},scrollToFocused(){this.$nextTick(()=>{const e=this.$refs.treeWrapper?.querySelector(".is-focused");e&&e.scrollIntoView({block:"nearest"})})}}};var Z=t(1493),ee={};ee.styleTagTransform=B(),ee.setAttributes=j(),ee.insert=_().bind(null,"head"),ee.domAPI=O(),ee.insertStyleElement=K(),z()(Z.A,ee),Z.A&&Z.A.locals&&Z.A.locals;const ne=(0,G.A)(Y,[["render",function(e,n,t,b,y,k){const w=(0,r.g2)("FileDocument"),I=(0,r.g2)("ChevronDown"),C=(0,r.g2)("Magnify"),T=(0,r.g2)("Close"),P=(0,r.g2)("NcLoadingIcon"),S=(0,r.g2)("PageTreeSelectItem");return(0,r.uX)(),(0,r.CE)("div",s,[(0,r.Q3)(" Selected value / trigger "),(0,r.Lk)("button",{type:"button",class:(0,o.C4)(["select-trigger",{"is-open":y.isOpen,"has-value":k.selectedPage,"is-disabled":t.disabled}]),disabled:t.disabled,onClick:n[0]||(n[0]=(...e)=>k.toggleDropdown&&k.toggleDropdown(...e)),ref:"trigger"},[k.selectedPage?((0,r.uX)(),(0,r.CE)("span",l,[(0,r.bF)(w,{size:16,class:"selected-icon"}),k.selectedPath?((0,r.uX)(),(0,r.CE)("span",d,(0,o.v_)(k.selectedPath)+" /",1)):(0,r.Q3)("v-if",!0),(0,r.Lk)("span",c,(0,o.v_)(k.selectedPage.title),1)])):((0,r.uX)(),(0,r.CE)("span",u,(0,o.v_)(t.placeholder),1)),(0,r.bF)(I,{size:18,class:(0,o.C4)(["trigger-icon",{rotated:y.isOpen}])},null,8,["class"])],10,i),(0,r.Q3)(" Dropdown "),y.isOpen?((0,r.uX)(),(0,r.CE)("div",h,[(0,r.Q3)(" Search input "),(0,r.Lk)("div",p,[(0,r.bF)(C,{size:16,class:"search-icon"}),(0,r.bo)((0,r.Lk)("input",{ref:"searchInput","onUpdate:modelValue":n[1]||(n[1]=e=>y.searchQuery=e),type:"text",class:"search-input",placeholder:k.t("Search pages..."),onKeydown:[n[2]||(n[2]=(0,a.jR)((...e)=>k.closeDropdown&&k.closeDropdown(...e),["escape"])),n[3]||(n[3]=(0,a.jR)((0,a.D$)((...e)=>k.focusNext&&k.focusNext(...e),["prevent"]),["down"])),n[4]||(n[4]=(0,a.jR)((0,a.D$)((...e)=>k.focusPrev&&k.focusPrev(...e),["prevent"]),["up"])),n[5]||(n[5]=(0,a.jR)((0,a.D$)((...e)=>k.selectFocused&&k.selectFocused(...e),["prevent"]),["enter"]))]},null,40,g),[[a.Jo,y.searchQuery]]),y.searchQuery?((0,r.uX)(),(0,r.CE)("button",{key:0,class:"clear-search",onClick:n[6]||(n[6]=e=>y.searchQuery="")},[(0,r.bF)(T,{size:14})])):(0,r.Q3)("v-if",!0)]),(0,r.Q3)(" Tree list "),(0,r.Lk)("div",v,[y.loading?((0,r.uX)(),(0,r.CE)("div",m,[(0,r.bF)(P,{size:24})])):0===k.filteredTree.length?((0,r.uX)(),(0,r.CE)("div",f,(0,o.v_)(y.searchQuery?k.t("No pages found"):k.t("No pages available")),1)):((0,r.uX)(),(0,r.CE)("ul",x,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(k.filteredTree,e=>((0,r.uX)(),(0,r.Wv)(S,{key:e.uniqueId,item:e,"expanded-nodes":y.expandedNodes,"selected-id":t.modelValue,"focused-id":y.focusedId,"search-query":y.searchQuery,onToggle:k.toggleNode,onSelect:k.selectPage,onFocus:n[7]||(n[7]=e=>y.focusedId=e)},null,8,["item","expanded-nodes","selected-id","focused-id","search-query","onToggle","onSelect"]))),128))]))],512),(0,r.Q3)(" Clear selection "),k.selectedPage&&t.clearable?((0,r.uX)(),(0,r.CE)("button",{key:0,class:"clear-selection",onClick:n[8]||(n[8]=(...e)=>k.clearSelection&&k.clearSelection(...e))},[(0,r.bF)(T,{size:16}),(0,r.eW)(" "+(0,o.v_)(k.t("Clear selection")),1)])):(0,r.Q3)("v-if",!0)],512)):(0,r.Q3)("v-if",!0)],512)}],["__scopeId","data-v-312268b0"]])}}]);